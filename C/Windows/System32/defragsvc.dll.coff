Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\defragsvc.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    OLEAUT32.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-io-l1-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    ntdll.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-core-file-l1-2-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-interlocked-l1-1-0.dll
    api-ms-win-eventing-provider-l1-1-0.dll
    api-ms-win-core-kernel32-legacy-l1-1-1.dll
    api-ms-win-core-registry-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-string-l2-1-0.dll
    api-ms-win-core-string-obsolete-l1-1-0.dll
    api-ms-win-core-memory-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-service-core-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-service-management-l2-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    VirtDisk.dll
    SXSHARED.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-eventlog-legacy-l1-1-0.dll
    api-ms-win-core-realtime-l1-1-0.dll
    api-ms-win-core-timezone-l1-1-0.dll
    api-ms-win-core-file-l2-1-0.dll
    api-ms-win-core-synch-l1-2-1.dll
    api-ms-win-core-libraryloader-l1-2-1.dll
    api-ms-win-core-delayload-l1-1-1.dll
    api-ms-win-core-delayload-l1-1-0.dll
    api-ms-win-eventing-controller-l1-1-0.dll

  Image has the following delay load dependencies:

    api-ms-win-core-com-l1-1-0.dll
    api-ms-win-devices-config-l1-1-1.dll
    api-ms-win-security-provider-l1-1-0.dll
    api-ms-win-security-lsalookup-l2-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll

  Section contains the following exports for defragsvc.dll

    00000000 characteristics
    8D52B8DF time date stamp
        0.00 version
           1 ordinal base
           5 number of functions
           5 number of names

    ordinal hint RVA      name

          1    0 000242A0 DllCanUnloadNow
          2    1 000242C0 DllGetClassObject
          3    2 000242E0 DllRegisterServer
          4    3 00024380 DllUnregisterServer
          5    4 000245A0 ServiceMain

  Section contains the following imports:

    msvcrt.dll
             180065A30 Import Address Table
             180077BA8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4B1 qsort
                         4A0 memcpy_s
                         443 fclose
                         44B fgetws
                         49F memcpy
                         3D0 _wfopen
                         4E9 swprintf_s
                         413 _wtoi64
                         3A1 _wcsnicmp
                         4A1 memmove
                         29C _onexit
                         485 iswspace
                          84 __dllonexit
                         34E _unlock
                         1F2 _lock
                          12 ??1type_info@@UEAA@XZ
                          34 ?terminate@@YAXXZ
                         189 _initterm
                         36D _vscwprintf
                          5A _XcptFilter
                         521 wcsstr
                          62 __CxxFrameHandler3
                          50 _CxxThrowException
                          C8 _callnewh
                           B ??0exception@@QEAA@AEBQEBDH@Z
                         376 _vsnwprintf
                         4B6 realloc
                         4CE strchr
                          63 __CxxFrameHandler4
                         50D wcscat_s
                         493 malloc
                         459 free
                          5E __C_specific_handler
                         2AA _purecall
                          36 ?what@exception@@UEBAPEBDXZ
                         397 _wcsicmp
                           A ??0exception@@QEAA@AEBQEBD@Z
                          11 ??1exception@@UEAA@XZ
                           C ??0exception@@QEAA@AEBV0@@Z
                          14 ??3@YAXPEAX@Z
                          B7 _amsg_exit
                          23 ??_V@YAXPEAX@Z
                         49E memcmp
                         4A3 memset

    OLEAUT32.dll
             180065410 Import Address Table
             180077588 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal     2
                             Ordinal   277
                             Ordinal     6

    api-ms-win-core-file-l1-1-0.dll
             1800654A8 Import Address Table
             180077620 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          15 FindFirstFileW
                           A DeleteFileW
                          2D GetFileAttributesW
                          1B FindNextFileW
                          58 SetFilePointer
                           7 CreateFileW
                           D FindClose
                          44 GetVolumeInformationW
                          51 SetEndOfFile
                          5B SetFileValidData
                          3D GetTempFileNameW
                          25 GetDiskFreeSpaceW
                          29 GetDriveTypeW
                          1F FlushFileBuffers
                          46 GetVolumePathNameW
                          2E GetFileInformationByHandle
                           4 CreateDirectoryW
                          4C ReadFile
                          1E FindVolumeClose
                          1D FindNextVolumeW
                          17 FindFirstVolumeW

    api-ms-win-core-sysinfo-l1-1-0.dll
             1800658D0 Import Address Table
             180077A48 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1E GetVersionExW
                          1A GetTickCount
                          16 GetSystemTimeAsFileTime
                          1B GetTickCount64
                           5 GetLocalTime
                          11 GetSystemInfo
                           F GetSystemDirectoryW

    api-ms-win-core-io-l1-1-0.dll
             1800655F8 Import Address Table
             180077770 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 DeviceIoControl

    api-ms-win-core-errorhandling-l1-1-0.dll
             180065480 Import Address Table
             1800775F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 UnhandledExceptionFilter
                           F SetUnhandledExceptionFilter
                           5 GetLastError
                           D SetLastError

    api-ms-win-core-synch-l1-1-0.dll
             180065820 Import Address Table
             180077998 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CancelWaitableTimer
                          19 InitializeCriticalSectionAndSpinCount
                          11 EnterCriticalSection
                           F DeleteCriticalSection
                          1D LeaveCriticalSection
                           6 CreateEventW
                          29 SetEvent
                          18 InitializeCriticalSection
                          2A SetWaitableTimer
                          27 ResetEvent
                          36 WaitForSingleObject
                          35 WaitForMultipleObjectsEx
                          26 ReleaseSemaphore
                           D CreateWaitableTimerExW

    ntdll.dll
             180065B98 Import Address Table
             180077D10 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         575 RtlRbInsertNodeEx
                         526 RtlNumberOfSetBits
                         576 RtlRbRemoveNode
                         5B4 RtlSetBits
                         3F4 RtlFindLongestRunClear
                         683 RtlpEnsureBufferSize
                         51D RtlNtPathNameToDosPathName
                         414 RtlFreeUnicodeString
                         3AF RtlDosPathNameToRelativeNtPathName_U
                         4CD RtlIsDosDeviceName_U
                         587 RtlReleaseRelativeName
                         1AA NtOpenFile
                         172 NtFsControlFile
                         1DB NtQueryDirectoryFileEx
                         492 RtlInitializeCriticalSection
                         101 NtClose
                         3C3 RtlEnterCriticalSection
                         4ED RtlLeaveCriticalSection
                         385 RtlDeleteCriticalSection
                         3EB RtlFindClearBits
                         317 RtlClearBits
                         29D NtWaitForSingleObject
                         3F8 RtlFindSetBits
                         3CB RtlEnumerateGenericTableWithoutSplayingAvl
                         388 RtlDeleteElementGenericTableAvlEx
                         48D RtlInitializeBitMap
                         11C NtCreateFile
                         387 RtlDeleteElementGenericTableAvl
                         3C8 RtlEnumerateGenericTableAvl
                         498 RtlInitializeGenericTableAvl
                         3E2 RtlExtractBitMap
                         3F7 RtlFindNextForwardRunClear
                         4A2 RtlInsertElementGenericTableAvl
                         43E RtlGetLastNtStatus
                         489 RtlInitUnicodeString
                         258 NtSetInformationProcess
                         51E RtlNtStatusToDosError
                         1DA NtQueryDirectoryFile
                          56 EtwUnregisterTraceGuids
                          4F EtwRegisterTraceGuidsW
                          46 EtwGetTraceEnableFlags
                          47 EtwGetTraceEnableLevel
                          48 EtwGetTraceLoggerHandle
                         2E4 RtlAllocateHeap
                         44F RtlGetPersistedStateLocation
                         40D RtlFreeHeap
                         5D9 RtlSetThreadErrorMode
                         20C NtQueryVolumeInformationFile
                          54 EtwTraceMessage
                         25B NtSetInformationThread

    api-ms-win-core-synch-l1-2-0.dll
             180065898 Import Address Table
             180077A10 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2E SleepConditionVariableCS
                          39 WakeAllConditionVariable
                          17 InitializeConditionVariable
                          2D Sleep

    api-ms-win-core-file-l1-2-0.dll
             180065558 Import Address Table
             1800776D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          45 GetVolumeNameForVolumeMountPointW
                          47 GetVolumePathNamesForVolumeNameW

    api-ms-win-core-processthreads-l1-1-0.dll
             1800656D0 Import Address Table
             180077848 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           C GetCurrentProcess
                          57 TlsAlloc
                          36 OpenThreadToken
                          55 TerminateProcess
                           D GetCurrentProcessId
                          34 OpenProcessToken
                          59 TlsGetValue
                          5A TlsSetValue
                          10 GetCurrentThread
                          58 TlsFree
                          11 GetCurrentThreadId
                           6 CreateThread

    api-ms-win-core-handle-l1-1-0.dll
             180065588 Import Address Table
             180077700 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-interlocked-l1-1-0.dll
             1800655D8 Import Address Table
             180077750 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 InterlockedPopEntrySList
                           0 InitializeSListHead
                           3 InterlockedPushEntrySList

    api-ms-win-eventing-provider-l1-1-0.dll
             180065940 Import Address Table
             180077AB8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 EventWriteTransfer
                           4 EventSetInformation
                           5 EventUnregister
                           3 EventRegister

    api-ms-win-core-kernel32-legacy-l1-1-1.dll
             180065608 Import Address Table
             180077780 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          4C PowerCreateRequest
                          4D PowerSetRequest
                          4B PowerClearRequest

    api-ms-win-core-registry-l1-1-0.dll
             180065758 Import Address Table
             1800778D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          25 RegQueryValueExW
                          2E RegSetValueExW
                           9 RegDeleteTreeW
                           3 RegCreateKeyExW
                          10 RegEnumValueW
                          21 RegQueryInfoKeyW
                           E RegEnumKeyExW
                          1E RegOpenKeyExW
                           0 RegCloseKey
                           B RegDeleteValueW

    api-ms-win-core-rtlsupport-l1-1-0.dll
             1800657B0 Import Address Table
             180077928 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         307 RtlCaptureStackBackTrace
                         324 RtlCompareMemory
                         305 RtlCaptureContext
                         509 RtlLookupFunctionEntry
                         64E RtlVirtualUnwind

    api-ms-win-core-libraryloader-l1-2-0.dll
             180065628 Import Address Table
             1800777A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          19 LoadLibraryExW
                          15 GetModuleHandleW
                          16 GetProcAddress
                          13 GetModuleHandleExA
                           D FreeLibrary
                          21 SizeofResource
                          11 GetModuleFileNameW
                           A FindResourceExW
                          1D LoadStringW
                          1B LoadResource

    api-ms-win-core-string-l2-1-0.dll
             1800657F0 Import Address Table
             180077968 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CharNextW
                           3 CharPrevW

    api-ms-win-core-string-obsolete-l1-1-0.dll
             180065808 Import Address Table
             180077980 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 lstrcpynW
                           5 lstrcmpiW

    api-ms-win-core-memory-l1-1-0.dll
             1800656A0 Import Address Table
             180077818 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          36 VirtualProtect
                          39 VirtualQuery
                          2D VirtualAlloc

    api-ms-win-core-string-l1-1-0.dll
             1800657E0 Import Address Table
             180077958 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 MultiByteToWideChar

    api-ms-win-core-heap-l1-1-0.dll
             180065598 Import Address Table
             180077710 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 HeapDestroy
                           4 HeapCreate
                           9 HeapReAlloc
                           2 HeapAlloc

    api-ms-win-service-core-l1-1-0.dll
             1800659D8 Import Address Table
             180077B50 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A SetServiceStatus
                           9 RegisterServiceCtrlHandlerExW

    api-ms-win-service-management-l1-1-0.dll
             1800659F0 Import Address Table
             180077B68 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 OpenSCManagerW
                           2 CreateServiceW
                           5 OpenServiceW
                           0 CloseServiceHandle
                           3 DeleteService

    api-ms-win-service-management-l2-1-0.dll
             180065A20 Import Address Table
             180077B98 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 ChangeServiceConfig2W

    api-ms-win-security-base-l1-1-0.dll
             180065988 Import Address Table
             180077B00 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          29 DuplicateTokenEx
                          15 AdjustTokenPrivileges
                          42 GetTokenInformation
                          48 InitializeSecurityDescriptor
                          23 CreateWellKnownSid
                          64 SetSecurityDescriptorOwner
                          63 SetSecurityDescriptorGroup
                          1B CheckTokenMembership
                          62 SetSecurityDescriptorDacl

    api-ms-win-core-heap-l2-1-0.dll
             1800655C0 Import Address Table
             180077738 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 LocalAlloc
                           A LocalFree

    api-ms-win-core-profile-l1-1-0.dll
             180065738 Import Address Table
             1800778B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    VirtDisk.dll
             180065450 Import Address Table
             1800775C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           E GetStorageDependencyInformation

    SXSHARED.dll
             180065430 Import Address Table
             1800775A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 SxTracerDebuggerBreak
                           8 SxTracerGetThreadContextRetail
                           9 SxTracerShouldTrackFailure

    api-ms-win-core-localization-l1-2-0.dll
             180065690 Import Address Table
             180077808 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 FormatMessageW

    api-ms-win-core-processenvironment-l1-1-0.dll
             1800656C0 Import Address Table
             180077838 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ExpandEnvironmentStringsW

    api-ms-win-eventlog-legacy-l1-1-0.dll
             180065968 Import Address Table
             180077AE0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 ReportEventW
                           3 RegisterEventSourceW
                           0 DeregisterEventSource

    api-ms-win-core-realtime-l1-1-0.dll
             180065748 Import Address Table
             1800778C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 QueryUnbiasedInterruptTime

    api-ms-win-core-timezone-l1-1-0.dll
             180065910 Import Address Table
             180077A88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A SystemTimeToFileTime

    api-ms-win-core-file-l2-1-0.dll
             180065570 Import Address Table
             1800776E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 GetFileInformationByHandleEx
                           8 MoveFileExW

    api-ms-win-core-synch-l1-2-1.dll
             1800658C0 Import Address Table
             180077A38 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 CreateSemaphoreW

    api-ms-win-core-libraryloader-l1-2-1.dll
             180065680 Import Address Table
             1800777F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          40 LoadLibraryW

    api-ms-win-core-delayload-l1-1-1.dll
             180065470 Import Address Table
             1800775E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ResolveDelayLoadedAPI

    api-ms-win-core-delayload-l1-1-0.dll
             180065460 Import Address Table
             1800775D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 DelayLoadFailureHook

    api-ms-win-eventing-controller-l1-1-0.dll
             180065920 Import Address Table
             180077A98 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 StartTraceW
                           0 ControlTraceW
                           1 EnableTraceEx2

  Section contains the following delay load imports:

    api-ms-win-core-com-l1-1-0.dll
              00000001 Characteristics
      000000018007F7E0 Address of HMODULE
      0000000180084000 Import Address Table
      0000000180076E38 Import Name Table
      00000001800770A8 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180003E66    42 CoTaskMemAlloc
                                    0000000180004220    3B CoRevertToSelf
                                    0000000180003EF1    43 CoTaskMemFree
                                    0000000180003F03     8 CoCreateGuid
                                    0000000180003F15    28 CoInitializeEx
                                    0000000180003F27    46 CoUninitialize
                                    0000000180003F39    44 CoTaskMemRealloc
                                    000000018000420E    26 CoImpersonateClient
                                    0000000180004171    1F CoGetMalloc
                                    0000000180003FD6     9 CoCreateInstance
                                    00000001800040BB     F CoDisconnectContext
                                    00000001800040A9    3C CoRevokeClassObject
                                    0000000180004085    29 CoInitializeSecurity
                                    0000000180004097    34 CoRegisterClassObject

    api-ms-win-devices-config-l1-1-1.dll
              00000001 Characteristics
      000000018007F7E8 Address of HMODULE
      0000000180084078 Import Address Table
      0000000180076EB0 Import Name Table
      00000001800770E0 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180003F4B    E5 CM_Unregister_Notification
                                    0000000180003FE8    BD CM_Register_Notification

    api-ms-win-security-provider-l1-1-0.dll
              00000001 Characteristics
      000000018007F7F0 Address of HMODULE
      00000001800840A0 Import Address Table
      0000000180076ED8 Import Name Table
      0000000180077100 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180003FFA     3 SetEntriesInAclW

    api-ms-win-security-lsalookup-l2-1-0.dll
              00000001 Characteristics
      000000018007F7F8 Address of HMODULE
      0000000180084090 Import Address Table
      0000000180076EC8 Import Name Table
      0000000180077138 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180004183     4 LookupPrivilegeValueW

    api-ms-win-security-sddl-l1-1-0.dll
              00000001 Characteristics
      000000018007F800 Address of HMODULE
      00000001800840B0 Import Address Table
      0000000180076EE8 Import Name Table
      0000000180077158 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180004232     2 ConvertStringSecurityDescriptorToSecurityDescriptorW

  Summary

        6000 .data
        1000 .didat
        4000 .pdata
       17000 .rdata
        1000 .reloc
        1000 .rsrc
       62000 .text
