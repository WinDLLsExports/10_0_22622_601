Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\shsetup.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-2-0.dll
    api-ms-win-core-com-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-service-management-l2-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-path-l1-1-0.dll
    api-ms-win-security-lsalookup-l2-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-debug-l1-1-0.dll
    api-ms-win-core-timezone-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    api-ms-win-security-lsapolicy-l1-1-0.dll
    ntdll.dll
    api-ms-win-core-shlwapi-obsolete-l1-1-0.dll
    api-ms-win-shcore-registry-l1-1-0.dll
    api-ms-win-security-provider-l1-1-0.dll
    api-ms-win-core-shlwapi-legacy-l1-1-0.dll
    api-ms-win-shell-shdirectory-l1-1-0.dll
    api-ms-win-core-string-obsolete-l1-1-0.dll
    api-ms-win-shell-shellcom-l1-1-0.dll
    api-ms-win-shcore-obsolete-l1-1-0.dll
    api-ms-win-core-registry-l2-1-0.dll
    api-ms-win-core-registryuserspecific-l1-1-0.dll
    api-ms-win-shcore-sysinfo-l1-1-0.dll
    api-ms-win-shcore-unicodeansi-l1-1-0.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-delayload-l1-1-1.dll
    api-ms-win-core-delayload-l1-1-0.dll

  Image has the following delay load dependencies:

    samcli.dll
    netutils.dll
    USERENV.dll
    SAMLIB.dll
    ext-ms-win-ntuser-message-l1-1-0.dll
    ext-ms-win-ntuser-window-l1-1-0.dll
    ext-ms-win-ole32-bindctx-l1-1-0.dll
    ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll
    ext-ms-win-shell-shell32-l1-2-2.dll
    ext-ms-win-shell-shell32-l1-2-0.dll
    api-ms-win-shell-namespace-l1-1-0.dll
    api-ms-win-shlwapi-ie-l1-1-0.dll
    WDSCORE.dll
    SHCORE.dll

  Section contains the following exports for shsetup.dll

    00000000 characteristics
    4FEDB77D time date stamp
        0.00 version
           1 ordinal base
           5 number of functions
           5 number of names

    ordinal hint RVA      name

          1    0 00011160 SHUnattendedSetup
          2    1 00011160 SHUnattendedSetupA
          3    2 000111F0 SHUnattendedSetupW
          4    3 00010240 Sysprep_Cleanup_Shell
          5    4 00010490 Sysprep_Generalize_Shell

  Section contains the following imports:

    msvcrt.dll
             1800167D0 Import Address Table
             180021B68 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4A0 memcpy_s
                         50E wcschr
                          C8 _callnewh
                         4A1 memmove
                          5A _XcptFilter
                         376 _vsnwprintf
                         459 free
                          B7 _amsg_exit
                         493 malloc
                          62 __CxxFrameHandler3
                         4F9 towupper
                         29C _onexit
                         49F memcpy
                          84 __dllonexit
                         189 _initterm
                          5E __C_specific_handler
                         1F2 _lock
                         34E _unlock
                         2AA _purecall
                         4A3 memset

    api-ms-win-core-errorhandling-l1-1-0.dll
             1800162D0 Import Address Table
             180021668 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D SetLastError
                           F SetUnhandledExceptionFilter
                          11 UnhandledExceptionFilter
                           5 GetLastError

    api-ms-win-core-registry-l1-1-0.dll
             180016478 Import Address Table
             180021810 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          18 RegLoadKeyW
                          30 RegUnLoadKeyW
                          2E RegSetValueExW
                           E RegEnumKeyExW
                           0 RegCloseKey
                          1E RegOpenKeyExW
                           3 RegCreateKeyExW
                          14 RegGetValueW
                          21 RegQueryInfoKeyW
                           B RegDeleteValueW

    api-ms-win-security-sddl-l1-1-0.dll
             1800166F8 Import Address Table
             180021A90 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ConvertStringSecurityDescriptorToSecurityDescriptorW
                           1 ConvertSidToStringSidW

    api-ms-win-core-heap-l2-1-0.dll
             180016370 Import Address Table
             180021708 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 LocalAlloc
                           3 LocalFree

    api-ms-win-core-sysinfo-l1-1-0.dll
             1800165D8 Import Address Table
             180021970 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          29 SetLocalTime
                           3 GetComputerNameExW
                           5 GetLocalTime
                           F GetSystemDirectoryW
                          1A GetTickCount
                          16 GetSystemTimeAsFileTime

    api-ms-win-core-string-l1-1-0.dll
             180016560 Import Address Table
             1800218F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 CompareStringOrdinal

    api-ms-win-core-sysinfo-l1-2-0.dll
             180016610 Import Address Table
             1800219A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          27 SetComputerNameExW

    api-ms-win-core-com-l1-1-0.dll
             180016250 Import Address Table
             1800215E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 CoCreateGuid
                          43 CoTaskMemFree
                          28 CoInitializeEx
                          46 CoUninitialize
                          1F CoGetMalloc
                          42 CoTaskMemAlloc
                           9 CoCreateInstance

    api-ms-win-core-file-l1-1-0.dll
             1800162F8 Import Address Table
             180021690 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D GetFileAttributesW
                          55 SetFileAttributesW
                           2 CompareFileTime
                          44 GetVolumeInformationW
                          2C GetFileAttributesExW
                           A DeleteFileW
                          46 GetVolumePathNameW
                           4 CreateDirectoryW

    api-ms-win-security-base-l1-1-0.dll
             180016638 Import Address Table
             1800219D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 CreateWellKnownSid
                          41 GetSidSubAuthorityCount
                          38 GetSecurityDescriptorDacl
                          3F GetSidLengthRequired
                          1E CopySid
                          3B GetSecurityDescriptorOwner
                          40 GetSidSubAuthority
                          3E GetSidIdentifierAuthority
                          15 AdjustTokenPrivileges
                          35 GetLengthSid
                          49 InitializeSid
                          42 GetTokenInformation

    api-ms-win-service-management-l1-1-0.dll
             180016710 Import Address Table
             180021AA8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseServiceHandle
                           4 OpenSCManagerW
                           6 StartServiceW
                           5 OpenServiceW

    api-ms-win-service-management-l2-1-0.dll
             180016738 Import Address Table
             180021AD0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 QueryServiceStatusEx

    api-ms-win-core-synch-l1-2-0.dll
             1800165C8 Import Address Table
             180021960 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D Sleep

    api-ms-win-service-winsvc-l1-1-0.dll
             180016748 Import Address Table
             180021AE0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A QueryServiceStatus

    api-ms-win-core-libraryloader-l1-2-0.dll
             180016388 Import Address Table
             180021720 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 GetModuleFileNameA
                          14 GetModuleHandleExW
                          15 GetModuleHandleW
                           1 DisableThreadLibraryCalls
                          16 GetProcAddress
                           D FreeLibrary
                          19 LoadLibraryExW

    api-ms-win-core-path-l1-1-0.dll
             1800163E8 Import Address Table
             180021780 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 PathCchCombine
                           5 PathCchAppend
                           2 PathCchAddBackslash
                          10 PathCchRemoveFileSpec

    api-ms-win-security-lsalookup-l2-1-0.dll
             1800166A0 Import Address Table
             180021A38 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 LookupPrivilegeValueW
                           1 LookupAccountSidW

    api-ms-win-core-handle-l1-1-0.dll
             180016340 Import Address Table
             1800216D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-synch-l1-1-0.dll
             180016588 Import Address Table
             180021920 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 ReleaseMutex
                           9 CreateMutexExW
                          26 ReleaseSemaphore
                          37 WaitForSingleObjectEx
                          36 WaitForSingleObject
                          21 OpenSemaphoreW
                           B CreateSemaphoreExW

    api-ms-win-core-heap-l1-1-0.dll
             180016350 Import Address Table
             1800216E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 HeapAlloc
                           6 HeapFree
                           0 GetProcessHeap

    api-ms-win-core-localization-l1-2-0.dll
             1800163C8 Import Address Table
             180021760 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          15 GetLocaleInfoW
                           9 FormatMessageW
                           A GetACP

    api-ms-win-core-processthreads-l1-1-0.dll
             180016420 Import Address Table
             1800217B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 GetCurrentThreadId
                           8 ExitProcess
                          34 OpenProcessToken
                          36 OpenThreadToken
                           C GetCurrentProcess
                          55 TerminateProcess
                          10 GetCurrentThread
                           D GetCurrentProcessId

    api-ms-win-core-debug-l1-1-0.dll
             180016290 Import Address Table
             180021628 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 DebugBreak
                           7 OutputDebugStringW
                           5 IsDebuggerPresent

    api-ms-win-core-timezone-l1-1-0.dll
             180016620 Import Address Table
             1800219B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 SetDynamicTimeZoneInformation
                           2 GetDynamicTimeZoneInformation

    api-ms-win-core-rtlsupport-l1-1-0.dll
             1800164F0 Import Address Table
             180021888 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 RtlCaptureContext
                          11 RtlVirtualUnwind
                           B RtlLookupFunctionEntry

    api-ms-win-core-profile-l1-1-0.dll
             180016468 Import Address Table
             180021800 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    api-ms-win-security-lsapolicy-l1-1-0.dll
             1800166B8 Import Address Table
             180021A50 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 LsaFreeMemory
                           1 LsaClose
                           E LsaOpenPolicy
                          16 LsaStorePrivateData
                          10 LsaQueryInformationPolicy

    ntdll.dll
             180016878 Import Address Table
             180021C10 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         153 NtDeviceIoControlFile
                         101 NtClose
                         51E RtlNtStatusToDosError
                         677 RtlWriteRegistryValue
                         2EE RtlAppendUnicodeStringToString
                         2EF RtlAppendUnicodeToString
                         7B2 ZwEnumerateKey
                         756 ZwClose
                         801 ZwOpenKey
                         489 RtlInitUnicodeString
                         1AA NtOpenFile

    api-ms-win-core-shlwapi-obsolete-l1-1-0.dll
             180016530 Import Address Table
             1800218C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 StrCmpICW
                          13 StrCmpLogicalW
                          39 StrToIntW
                          1A StrCmpNIW
                          12 StrCmpIW

    api-ms-win-shcore-registry-l1-1-0.dll
             180016768 Import Address Table
             180021B00 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          18 SHRegGetValueW
                          1C SHSetValueW
                           5 SHDeleteKeyW
                           7 SHDeleteValueW

    api-ms-win-security-provider-l1-1-0.dll
             1800166E8 Import Address Table
             180021A80 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 SetNamedSecurityInfoW

    api-ms-win-core-shlwapi-legacy-l1-1-0.dll
             180016510 Import Address Table
             1800218A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          18 PathFindFileNameW
                          28 PathIsRelativeW
                          56 SHExpandEnvironmentStringsW

    api-ms-win-shell-shdirectory-l1-1-0.dll
             1800167B0 Import Address Table
             180021B48 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   290

    api-ms-win-core-string-obsolete-l1-1-0.dll
             180016570 Import Address Table
             180021908 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B lstrlenW
                           5 lstrcmpiW

    api-ms-win-shell-shellcom-l1-1-0.dll
             1800167C0 Import Address Table
             180021B58 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 SHCoCreateInstance

    api-ms-win-shcore-obsolete-l1-1-0.dll
             180016758 Import Address Table
             180021AF0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 SHStrDupW

    api-ms-win-core-registry-l2-1-0.dll
             1800164D0 Import Address Table
             180021868 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D RegEnumKeyW

    api-ms-win-core-registryuserspecific-l1-1-0.dll
             1800164E0 Import Address Table
             180021878 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           C SHRegGetBoolUSValueW

    api-ms-win-shcore-sysinfo-l1-1-0.dll
             180016790 Import Address Table
             180021B28 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 IsOS

    api-ms-win-shcore-unicodeansi-l1-1-0.dll
             1800167A0 Import Address Table
             180021B38 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 SHAnsiToUnicode

    api-ms-win-core-processenvironment-l1-1-0.dll
             180016410 Import Address Table
             1800217A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ExpandEnvironmentStringsW

    api-ms-win-core-delayload-l1-1-1.dll
             1800162C0 Import Address Table
             180021658 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ResolveDelayLoadedAPI

    api-ms-win-core-delayload-l1-1-0.dll
             1800162B0 Import Address Table
             180021648 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 DelayLoadFailureHook

  Section contains the following delay load imports:

    samcli.dll
              00000001 Characteristics
      0000000180023620 Address of HMODULE
      0000000180025138 Import Address Table
      0000000180020DB0 Import Name Table
      0000000180021020 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180001EDB    1E NetUserModalsGet
                                    0000000180001EED     C NetLocalGroupAddMembers
                                    0000000180001EFF    16 NetUserAdd
                                    0000000180001DA1    21 NetUserSetInfo
                                    0000000180001D16    1B NetUserGetInfo

    netutils.dll
              00000001 Characteristics
      0000000180023628 Address of HMODULE
      0000000180025128 Import Address Table
      0000000180020DA0 Import Name Table
      0000000180021038 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180001DB3     1 NetApiBufferFree

    USERENV.dll
              00000001 Characteristics
      0000000180023630 Address of HMODULE
      0000000180025048 Import Address Table
      0000000180020CC0 Import Name Table
      0000000180021048 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180001EC9       Ordinal   209
                                    0000000180001E3E    1D GetDefaultUserProfileDirectoryW

    SAMLIB.dll
              00000001 Characteristics
      0000000180023638 Address of HMODULE
      0000000180025000 Import Address Table
      0000000180020C78 Import Name Table
      0000000180021078 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180001F11     7 SamConnect
                                    0000000180001FD2    15 SamFreeMemory
                                    0000000180001FC0    33 SamSetInformationDomain
                                    0000000180001FAE    27 SamQueryInformationDomain
                                    0000000180001F9C    21 SamOpenDomain
                                    0000000180001FE4     6 SamCloseHandle

    ext-ms-win-ntuser-message-l1-1-0.dll
              00000001 Characteristics
      0000000180023640 Address of HMODULE
      00000001800250B0 Import Address Table
      0000000180020D28 Import Name Table
      00000001800210B0 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180002081    13 RegisterWindowMessageW
                                    0000000180001FF6     E PostMessageW

    ext-ms-win-ntuser-window-l1-1-0.dll
              00000001 Characteristics
      0000000180023648 Address of HMODULE
      00000001800250C8 Import Address Table
      0000000180020D40 Import Name Table
      00000001800210C8 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180002093    25 FindWindowW

    ext-ms-win-ole32-bindctx-l1-1-0.dll
              00000001 Characteristics
      0000000180023650 Address of HMODULE
      00000001800250D8 Import Address Table
      0000000180020D50 Import Name Table
      00000001800210D8 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000211E     1 CreateBindCtx

    ext-ms-win-rtcore-ntuser-sysparams-l1-1-0.dll
              00000001 Characteristics
      0000000180023658 Address of HMODULE
      00000001800250E8 Import Address Table
      0000000180020D60 Import Name Table
      00000001800210E8 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    00000001800021A9     6 EnumDisplaySettingsW
                                    0000000180002234     0 ChangeDisplaySettingsExW

    ext-ms-win-shell-shell32-l1-2-2.dll
              00000001 Characteristics
      0000000180023660 Address of HMODULE
      0000000180025110 Import Address Table
      0000000180020D88 Import Name Table
      0000000180021100 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180002246       Ordinal   265
                                    000000018000235C    2B SHEmptyRecycleBinW

    ext-ms-win-shell-shell32-l1-2-0.dll
              00000001 Characteristics
      0000000180023668 Address of HMODULE
      0000000180025100 Import Address Table
      0000000180020D78 Import Name Table
      0000000180021110 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    00000001800022D1    25 SHCreateItemInKnownFolder

    api-ms-win-shell-namespace-l1-1-0.dll
              00000001 Characteristics
      0000000180023670 Address of HMODULE
      0000000180025090 Import Address Table
      0000000180020D08 Import Name Table
      0000000180021128 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000236E    11 SHCreateItemFromParsingName

    api-ms-win-shlwapi-ie-l1-1-0.dll
              00000001 Characteristics
      0000000180023678 Address of HMODULE
      00000001800250A0 Import Address Table
      0000000180020D18 Import Name Table
      0000000180021138 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    00000001800023F9       Ordinal    24

    WDSCORE.dll
              00000001 Characteristics
      0000000180023680 Address of HMODULE
      0000000180025060 Import Address Table
      0000000180020CD8 Import Name Table
      0000000180021148 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180002484    59 WdsSetupLogMessageW
                                    000000018000250F     4 CurrentIP
                                    0000000180002521     3 ConstructPartialMsgVW
                                    0000000180002533    57 WdsSetupLogInit
                                    0000000180002545    56 WdsSetupLogDestroy

    SHCORE.dll
              00000001 Characteristics
      0000000180023688 Address of HMODULE
      0000000180025038 Import Address Table
      0000000180020CB0 Import Name Table
      0000000180021178 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180002557       Ordinal   131

  Summary

        1000 .data
        1000 .didat
        1000 .pdata
        D000 .rdata
        1000 .reloc
        1000 .rsrc
       15000 .text
