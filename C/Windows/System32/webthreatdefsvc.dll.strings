!This program cannot be run in DOS mode.
5RichX
.text
`.rdata
@.data
.pdata
@.rsrc
@.reloc
@SUVWH
L$`H3
x_^][
D$pE3
t$ WH
D$0E3
D$(E3
L$pH3
D$0E3
D$(E3
t$ UWAVH
D$(E3
@USVWATAUAVAWH
A_A^A]A\_^[]
@USVWATAUAVAWH
A_A^A]A\_^[]
L$0H3
@SUVWH
L$pH3
t$ WH
D$0E3
D$(E3
D$0E3
D$(E3
t$ UWATAVAWH
D$0E3
D$(E3
A_A^A\_]
q0R^G'
q0R^G'
q:_0#
|$ AVH
VWAVH
p:_0#
p:_0#
p:_0#
@A^_^
q:_0#
@SVWH
SVWAVH
8A^_^[
WAVAWH
\$8H;
A_A^_
p:_0#
\$ UH
M H1E
 H3E H3E
ntelA
ineID
x AVH
UWATAVAWH
D$ E3
D$ E3
A_A^A\_]
L$(H3
L$0H3
t$ WH
t$ WH
L$0H3
t$ WH
L$0H3
D$ E3
qB^Xh
WAVAWH
0A_A^_
D9Y s
D;Y L
WAVAWH
0A_A^_
WAVAWH
 A_A^_
D$@9P s
vb'vb'v
D$ H;
L$`H3
L$@H3
D$hE3
L$HE3
UVWATAUAVAWH
fF9,Fu
fE9,^u
D$ E3
fF9,Fu
fE9,^u
D$0fA
A_A^A]A\_^]
VWAVH
L$`H3
\$ VWAVH
L$HH3
PA^_^
u)A8q
Ap$"<
A L;IhH
BAhH+
T$ H;
L$`H3
T$ E3
t$ WAVAWH
 A_A^_
I9Jhs
I9Jhs
L$XH3
L$HH3
L$(E3
x AVH
WAVAWH
x ATAVAWH
A_A^A\
x AVH
WAVAWH
tBfE98t<I
 A_A^_
|$ UH
UVWAVAWH
A_A^_^]
WAVAWH
 A_A^_
\$ UVWAVAWH
t,D8=z
L9{Hu
A_A^_^]
D$8E3
D$(E3
x AVH
@SUVWH
D$0L;
D$@E3
UVWATAUAVAWH
fD98u
t'D8="
fE9>u
@A_A^A]A\_^]
L$ SWH
L$XH+
t$ WH
T$HE3
SVWAVAWH
`A_A^_^[
WATAUAVAWH
H9/sDH
 A_A^A]A\_
L$ SVWH
T$8E3
UVWATAUAVAWH
t$ HcD$$Hc
A_A^A]A\_^]
|$ UH
D$0E3
ug@89t`H
^ H9;t
L$0H9;t
|$ UATAUAVAWH
u.@8}
F8@88t
A_A^A]A\]
t$ WH
D#D$0D
3D$8%
3D$8%x
t$ WH
3D$8%
3D$8%x
VWAVH
 A^_^
USVWAVAWH
A_A^_^[]
s WAVAWH
@A_A^_
@SUWH
UVWAVAWH
~0H+~(H
0A_A^_^]
\$0I;
t$ WAVAWH
\$PfD
@u;L9;u$E3
0A_A^_
t$ WH
p WAVAWH
 A_A^_
t$ WH
WAVAWH
T$0L+
A_A^_
|$ UATAUAVAWH
A_A^A]A\]
UVWAVAWH
H!t$XA
D$H!D$@
A_A^_^]
T$HE3
L$ WH
9\$@L
x AVH
rHfD97w
C9fD97u,
VWAVH
t$$fD
D$0D9r
@A^_^
\$ UVWAVAWH
0A_A^_^]
UVWAVAWH
 A_A^_^]
t$ WH
{ ATAVAWH
 A_A^A\
UVWAVAWH
L$HH3
PA_A^_^]
D$(E3
h UAVAWH
L$@I+
L$PH;
T$PM;
A_A^]
UVWAVAWH
|$ fD
D$(H;
D$(H;
A_A^_^]
x AVH
\$ UVW
D$8E3
@SUVWATAVAW
A_A^A\_^][
t$ WATAUAVAWH
 A_A^A]A\_
WAVAWH
 A_A^_
x ATAVAWH
fD9#t
 A_A^A\
VWATAVAWH
fE9$@u
L$hH+
0A_A^A\_^
VWAVH
D$hE3
D$hE3
@A^_^
VhH;Vpt
D$XE3
@USVWATAVAWH
`A_A^A\_^[]
D$@E3
f99toM
D$pE3
UVWAVAWH
pa\P@?
L$`H3
pA_A^_^]
VWAVH
pa\P@?
0A^_^
(t$`I
VWATAVAWH
D9B }TH
;Z |jH
D$ D9@ }
A_A^A\_^
D$ E3
D$ E3
D$ E3
D$ E3
D$@E3
D$@E3
D$@E3
D$@E3
WAVAWH
0A_A^_
qa\P@?
@USWH
H!t$8
q0\Z-
t@L;P
qB^Xh
@SVWH
qB^Xh
@SVWH
L$@H3
L$HH3
UWATAVAWH
D9d$(|
t(D8%^
(t$pL
(t$`L
D9A s
x AVH
6H9s@t&H
UVWAVAWH
I;FPtaH
A_A^_^]
VWAVH
L$HE3
H;KPt!
 A^_^
\$ UVWAVAWH
A_A^_^]
UVWAVAWH
EHI;FPt.H
PA_A^_^]
D$`E3
D$(E3
|$ AVH
D$0H;
L$0L;
x AVH
@USVWH
bad allocation
AFailed register OnManagementSettingsUpdated() callback.
Failed register OnUserSettingsUpdated() callback.
onecore\amcore\webdefense\configuration\configurationmanager.cpp
Failed to get hydrate session.
Failed to get dehydrate session.
Failed to get UserServiceComponentManager for session.
onecore\amcore\webdefense\shared\QueryServices.h
onecore\amcore\webdefense\configuration\wtdsettingscom.cpp
ServiceEnabled
NotifyMalicious
NotifyPasswordReuse
NotifyUnsafeApp
onecore\amcore\webdefense\configuration\lib\RegistryHelper.h
The setting is not set in registry: 
`, default value will be used
` from registry: `
Failed to query settings `
onecore\amcore\webdefense\configuration\lib\settingsbase.cpp
IsDeviceRegisteredWithManagement() failed, assuming NotifyMalicious is on.
) failed in LoadSettings().
Unexpected, GetSettingDefaultValue(
callback failed in CheckForUpdatedSettingsAndNotify()
Software\Policies\Microsoft\Windows\WTDS\Components
RegisterWNFCallback(MDM) failed in ManagementSettings(), changes in MDM policies will take effect after reboot
onecore\amcore\webdefense\configuration\lib\managementsettings.cpp
RegisterWNFCallback(GP) failed in ManagementSettings(), changes in Group Policies will take effect after reboot
UnregisterWNFCallback(MDM) failed in ~ManagementSettings()
UnregisterWNFCallback(GP) failed in ~ManagementSettings()
Valid pointer of type ManagementSettings was expected in OnUpdateWNFCallback().
Software\Microsoft\Windows\CurrentVersion\WTDS\Components
onecore\amcore\webdefense\configuration\lib\usersettings.cpp
Unknown exception
Exception
ReturnNt
ReturnHr
LogNt
LogHr
FailFast
%hs(%u)\%hs!%p: 
%hs!%p: 
(caller: %p) 
%hs(%d) tid(%x) %08X %ws
Msg:[%ws] 
CallContext:[%hs] 
[%hs(%hs)]
[%hs]
kernelbase.dll
RaiseFailFastException
lstd::exception: %hs
onecore\internal\sdk\inc\wil\opensource\wil\resource.h
WilError_03
ntdll.dll
LdrFastFailInLoaderCallout
RtlNtStatusToDosErrorNoTeb
RtlDllShutdownInProgress
RtlDisownModuleHeapAllocation
WilFailureNotifyWatchers
Local\SM0:%lu:%lu:%hs
RtlQueryFeatureConfiguration
RtlRegisterFeatureConfigurationChangeNotification
RtlUnregisterFeatureConfigurationChangeNotification
RtlNotifyFeatureUsage
LogStagedFeatureUsage
NtQueryWnfStateData
NtUpdateWnfStateData
onecore\internal\sdk\inc\wil\Staging.h
WilStaging_02
Stopping service
Done stopping service
Starting service
onecore\amcore\webdefense\services\servicemaincommon.cpp
Service is not supported on multi-session platform, shutting down.
Done starting service
Unable to start service. The service has been disabled, shutting down.
ServiceMain Enter
ServiceMain Exit
Aonecore\internal\sdk\inc\wil\opensource\wil\win32_helpers.h
onecore\amcore\webdefense\services\service.cpp
Service: Failed to load module
Service: Initialization Begin
Service: failed to create stop event
Service: failed to register service control handler
Service: failed to register stop callback.
Service: Initialization End
Service: null context received from SCM for ServiceControlHandler.
Service: Stop callback invoked
Service: failed to stop service from stop callback
Service: Failed to start the service
Service: Failed to set service to stop pending state
Service: Failed to stop service
Failed to set service status, status = %d
Service: Successfully updated service state
SERVICE_CONTINUE_PENDING
SERVICE_PAUSE_PENDING
SERVICE_PAUSED
SERVICE_RUNNING
SERVICE_START_PENDING
SERVICE_STOP_PENDING
SERVICE_STOPPED
Unknown
vector too long
string too long
bad array new length
WebThreatDefSvc
\ThreatIntelligence.dll
WebThreatDefense Service: creating internal components
onecore\amcore\webdefense\services\webthreatdefsvc\servicemain.cpp
WebThreatDefense Service: initializing Configuration Manager
WebThreatDefense Service: initializing TIM
WebThreatDefense Service: registering COM server
WebThreatDefense Service: destroying internal components
WebThreatDefense Service: uninitializing Configuration Manager
WebThreatDefense Service: uninitializing TIM
WebThreatDefense Service: revoking COM server
activatibleClassId
map/set too long
Microsoft.OneCore.WebThreatDefense.Service.UserServiceComponentManager
Microsoft.OneCore.WebThreatDefense.Service.UserSessionServiceManager
Microsoft.OneCore.WebThreatDefense.ThreatResponseEngine.TempTRESessionManagerServerRegistrar
onecore\amcore\webdefense\services\webthreatdefsvc\temptresessionmanagerserverregistrar.cpp
Successfully registered TempTRESessionManager with COM for out-of-proc activation.
Microsoft.OneCore.WebThreatDefense.Configuration.WTDUserSettings
onecore\amcore\webdefense\services\webthreatdefsvc\usersessionservicemanager.cpp
onecore\amcore\webdefense\services\webthreatdefsvc\sessionservicesmap.cpp
SessionServicesMap: adding new service registration
SessionServicesMap: replacing existing service registration
SessionServicesMap::UnregisterServices
SessionServicesMap::UnregisterService
SessionServicesMap::FindService
Failure Info
ntdll.dll
MicrosoftTelemetryAssertTriggeredUM
Warning
Message
result
Warning
Message
result
Warning
Message
result
session
Warning
Message
result
session
Warning
Message
result
session
ConfigurationUpdated
serviceEnabled
notifyMalicious
notifyPasswordReuse
notifyUnsafeApp
serviceEnabledLocked
notifyMaliciousLocked
notifyPasswordReuseLocked
notifyUnsafeAppLocked
PartA_PrivTags
Verbose
Message
Verbose
Message
service
Error
Message
service
Message
service
Warning
Message
service
Message
service
result
Verbose
Message
newState
win32ExitCode
serviceSpecificExitCode
waitTimeMS
serviceName
Verbose
Message
Error
Message
Error
Message
modulePath.get()
ActiveSessionCountLimited
activeSessionCountLimited
PartA_PrivTags
Message
FallbackError
PartA_PrivTags
wilResult
hresult
fileName
lineNumber
module
failureType
message
threadId
callContext
originatingContextId
originatingContextName
originatingContextMessage
currentContextId
currentContextName
currentContextMessage
failureId
failureCount
function
FallbackError
PartA_PrivTags
wilResult
hresult
fileName
lineNumber
module
failureType
message
threadId
callContext
originatingContextId
originatingContextName
originatingContextMessage
currentContextId
currentContextName
currentContextMessage
Verbose
Message
sessionId
serviceId
Verbose
Message
sessionId
Verbose
Message
sessionId
service ptr
Warning
Message
sessionId
service ptr
Error
Message
Message
Line Number
Failure Type
Failure Count
Thread Id
HRESULT
Function
Microsoft.OneCore.WebThreatDefense.Service
Microsoft.OneCore.WebThreatDefense.Service
RSDS:,f
webthreatdefsvc.pdb
.text
.text$di
.text$mn
.text$mn$00
.text$x
.text$yd
.rdata$brc
.idata$5
.00cfg
.CRT$XCA
.CRT$XCU
.CRT$XCZ
.CRT$XIA
.CRT$XIC
.CRT$XIZ
.CRT$XPA
.CRT$XPZ
.CRT$XTA
.CRT$XTZ
.gehcont
.gfids
.rdata
.rdata$r
.rdata$voltmd
.rdata$zETW0
.rdata$zETW1
.rdata$zETW2
.rdata$zETW9
.rdata$zzzdbg
.rtc$IAA
.rtc$IZZ
.rtc$TAA
.rtc$TZZ
.xdata
.xdata$x
minATL$__a
minATL$__m
minATL$__z
.edata
.idata$2
.idata$3
.idata$4
.idata$6
.data$brc
.data$r$brc
.data$rs$brc
.data
.pdata
.rsrc$01
.rsrc$02
`hvJ3
`hvJ3
@08NJ3
webthreatdefsvc.dll
DllCanUnloadNow
DllGetActivationFactory
DllGetClassObject
DllRegisterServer
DllUnregisterServer
ServiceMain
SvchostPushServiceGlobals
?_Xlength_error@std@@YAXPEBD@Z
_Mtx_init_in_situ
_Mtx_destroy_in_situ
?_Throw_C_error@std@@YAXH@Z
_Mtx_lock
_Mtx_unlock
msvcp_win.dll
_initterm
_initterm_e
api-ms-win-crt-runtime-l1-1-0.dll
__CxxFrameHandler4
__std_terminate
_o___std_exception_copy
_o___std_exception_destroy
_o___std_type_info_destroy_list
_o___stdio_common_vsnprintf_s
_o___stdio_common_vswprintf
_o__callnewh
_o__cexit
_o__configure_narrow_argv
_o__crt_atexit
_o__errno
_o__execute_onexit_table
_o__initialize_narrow_environment
_o__initialize_onexit_table
_o__invalid_parameter_noinfo
_o__invalid_parameter_noinfo_noreturn
_o__purecall
_o__register_onexit_function
_o__seh_filter_dll
_o_free
_o_malloc
_o_terminate
__C_specific_handler
__current_exception
__current_exception_context
__CxxFrameHandler3
memset
_CxxThrowException
api-ms-win-crt-private-l1-1-0.dll
api-ms-win-crt-string-l1-1-0.dll
InitTIM
UninitTIM
ThreatIntelligence.DLL
GetModuleFileNameA
CreateSemaphoreExW
HeapFree
SetLastError
ReleaseSemaphore
GetModuleHandleExW
WaitForSingleObject
GetCurrentThreadId
ReleaseMutex
FormatMessageW
GetLastError
OutputDebugStringW
WaitForSingleObjectEx
OpenSemaphoreW
CloseHandle
HeapAlloc
GetProcAddress
CreateMutexExW
GetCurrentProcessId
GetProcessHeap
GetModuleHandleW
DebugBreak
IsDebuggerPresent
AcquireSRWLockExclusive
ReleaseSRWLockExclusive
AcquireSRWLockShared
ReleaseSRWLockShared
SetThreadpoolTimer
CreateThreadpoolTimer
LeaveCriticalSection
EnterCriticalSection
DeleteCriticalSection
InitializeCriticalSectionEx
DisableThreadLibraryCalls
WaitForThreadpoolTimerCallbacks
CloseThreadpoolTimer
EventWriteTransfer
CoTaskMemFree
FreeLibrary
LoadLibraryW
CreateEventW
RegisterServiceCtrlHandlerExW
SetEvent
SetServiceStatus
UnregisterWait
GetSystemDirectoryW
CoTaskMemAlloc
EventUnregister
EventSetInformation
EventRegister
VerSetConditionMask
VerifyVersionInfoW
DecodePointer
InitOnceBeginInitialize
InitOnceComplete
InitOnceExecuteOnce
EncodePointer
CoCreateFreeThreadedMarshaler
RaiseException
OpenThreadToken
GetCurrentThread
OpenProcessToken
GetCurrentProcess
GetTokenInformation
CoGetCallContext
RtlCaptureContext
RtlLookupFunctionEntry
RtlVirtualUnwind
UnhandledExceptionFilter
SetUnhandledExceptionFilter
TerminateProcess
IsProcessorFeaturePresent
QueryPerformanceCounter
GetSystemTimeAsFileTime
InitializeSListHead
RegCloseKey
RegOpenKeyExW
RegQueryValueExW
RegCreateKeyExW
RegSetValueExW
KERNEL32.dll
ADVAPI32.dll
OLE32.dll
RoUninitialize
RoInitialize
RoOriginateError
WindowsIsStringEmpty
WindowsStringHasEmbeddedNull
RoOriginateErrorW
WindowsGetStringRawBuffer
WindowsCreateString
RoRegisterActivationFactories
RoRevokeActivationFactories
WindowsCreateStringReference
WindowsDeleteString
RtlPublishWnfStateData
RoActivateInstance
RtlSubscribeWnfStateChangeNotification
RtlUnsubscribeWnfNotificationWaitForCompletion
NdrDllUnregisterProxy
NdrDllRegisterProxy
NdrDllGetClassObject
NdrDllCanUnloadNow
NdrOleFree
NdrOleAllocate
api-ms-win-core-winrt-l1-1-0.dll
api-ms-win-core-winrt-error-l1-1-0.dll
api-ms-win-core-winrt-string-l1-1-0.dll
ntdll.dll
RPCRT4.dll
IsDeviceRegisteredWithManagement
MDMRegistration.DLL
?uncaught_exception@std@@YA_NXZ
?_Xbad_function_call@std@@YAXXZ
??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAA@XZ
??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UEAA@XZ
?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QEAAHD@Z
?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QEAA_JPEBD_J@Z
?gbump@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAXH@Z
?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAPEADXZ
??1?$basic_ios@DU?$char_traits@D@std@@@std@@UEAA@XZ
?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QEAAXH_N@Z
??0?$basic_ios@DU?$char_traits@D@std@@@std@@IEAA@XZ
??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QEAA@PEAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z
??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UEAA@XZ
?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QEAAXXZ
??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QEAAAEAV01@_K@Z
?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QEAAAEAV12@XZ
?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAAXAEBVlocale@2@@Z
?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAAHXZ
?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAAPEAV12@PEAD_J@Z
?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAA_JPEBD_J@Z
?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAA_JPEAD_J@Z
?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAAHXZ
?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAA_JXZ
?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UEAAXXZ
?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UEAAXXZ
memcpy
memmove
GetModuleHandleExA
memcmp
.?AV<lambda_c41effd5a010bcd6bf28f6600c4230d0>@@
.?AV<lambda_c3b7d11ca7cdfff23baefc3176af863a>@@
.?AVbad_alloc@std@@
.?AVResultException@wil@@
.?AVexception@std@@
.?AVbad_array_new_length@std@@
.?AVtype_info@@
VS_VERSION_INFO
StringFileInfo
040904B0
CompanyName
Microsoft Corporation
FileDescription
Web Threat Defense Service
FileVersion
10.0.22621.1 (WinBuild.160101.0800)
InternalName
webthreatdefsvc
LegalCopyright
 Microsoft Corporation. All rights reserved.
OriginalFilename
webthreatdefsvc.dll
ProductName
Microsoft
 Windows
 Operating System
ProductVersion
10.0.22621.1
VarFileInfo
Translation
en-US
