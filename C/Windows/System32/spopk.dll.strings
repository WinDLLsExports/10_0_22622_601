!This program cannot be run in DOS mode.
Richd
.text
`.rdata
@.data
.pdata
@.didat
.rsrc
@.reloc
q0R^G'
ATAVAWH
p0R^G'
 A_A^A\
q:_0#
VWAVH
\$ E3
D$HE3
D$HE3
LcA<E3
HcQ<H
\$ UH
 H3E H3E
oD$ f
oL$0f
oT$@f
o\$PH
oD$ f
oL$0f
oT$@f
o\$PH
qq^Vc
Xv>7u
UWAWH
UATAUAVAWH
f94Xu
f94xu
fA;TE
u`9r t[
A_A^A]A\]
|$@E3
UATAUAVAWH
!t$PH!t$H
|$ E3
D$ E3
A_A^A]A\]
@USVWATAUAVAWH
d$ E3
D9egA
A_A^A]A\_^[]
t$ E3
D$ E3
UATAUAVAWH
fD9,Au
fD9,xu
t\fD;
A_A^A]A\]
|$@E3
H SUVWATAUAVAWH
(A_A^A]A\_^][
x AVH
x AVH
VWAVH
 A^_^
UVWAVAWH
f;|$0
L$0E3
A_A^_^]
L$ SWH
WATAUAVAWH
fD9,Au
fD9,Fu
fD9,nu
fF9,vu
 A_A^A]A\_
UVWATAUAVAWH
D9D$@
f;DLpu
D$@fD
f;DLhu
D$@fD
L9L$P
x"fE;>
x"fD;
A_A^A]A\_^]
\$(E3
UVWAVAWH
D$(E3
@A_A^_^]
VWAVH
L$PE3
L$(E3
UVWATAUAVAWH
fD9,Yu
fD9,ru
J[fD;
@A_A^A]A\_^]
x UATAUAVAWH
D$@uKI
A_A^A]A\]
H SUVWAVAWH
8A_A^_^][
f94Yu
L$ SVWH
@UVWATAUAVAWH
A_A^A]A\_^]
@USVWATAUAVAWH
A_A^A]A\_^[]
f;+u&H
\$PE3
UAUAVH
A^A]]
UVWATAUAVAWH
A_A^A]A\_^]
UWATAVAWH
D9u@uTL
A_A^A\_]
x AVH
]<[61
]<[61
]<[61
q@YtV
WAVAWH
f9,Bu
t.HcW H
 A_A^_
UVWATAUAVAWH
fD9,Xu
fE9,|u
D$`fD
A_A^A]A\_^]
SVWATAUAVAWH
L$ E3
\$`D9
A_A^A]A\_^[
p AWH
\$8E3
UATAUAVAWH
l$ E3
l$ E3
A_A^A]A\]
UVWATAUAVAWH
\$x!\$|
u!D9Mxu
LcexM
A_A^A]A\_^]
WAVAWH
fE9<Xu
|$@E3
A_A^_
UATAUAVAWH
D!t$PL
A_A^A]A\]
UVWATAUAVAWH
A_A^A]A\_^]
UATAVH
A^A\]
|$@E3
UVWATAUAVAWH
fD9,Zu
pA_A^A]A\_^]
|$@E3
UVWATAUAVAWH
fD9,Zu
pA_A^A]A\_^]
USVWATAUAVAWH
l$PE3
hA_A^A]A\_^[]
USVWATAUAVAWH
D!ugE3
D!t$PH
L!t$HL
|$@E3
EwD!uwL
D$8L!t$0
D!t$ H
L$(E3
D!t$PH
L!t$HL
|$@E3
A_A^A]A\_^[]
D!|$PH
L!|$HL
|$@E3
@USVWATAUAWH
\$8E3
pA_A]A\_^[]
D$ E3
f9<Au
f;LD>u
t$ WH
f9,Fu
f9,~u
D$DDtXH
@USWATAUAVAWH
EHt>H
t4A9F
t.HcC<
EPt>H
pA_A^A]A\_[]
VWAVH
0A^_^
\$ VWAVH
L9t$Ht2H
 A^_^
USVWAUAVAWH
tm9UPth
T$0E3
`A_A^A]_^[]
UVWATAUAVAWH
@A_A^A]A\_^]
@USVWATAUAVAWH
D9l$H
D9l$@
t)D9l$Ht"D
fD9,^u
D$HI;
D$@fD
fF94gu
A_A^A]A\_^[]
t$ WAVAWH
D$0E3
@A_A^_
x AVH
t$ UWAVH
x AVH
E(=csm
E8=csm
EH=csm
EX=csm
Eh=csm
Ex=csm
setupcl.dll
ServicingCommon.dll
Invalid parameter passed to C runtime function.
setupcl.dll
SclPendedRequestExists
SclGetPendedRequest
SclPendRequest
SclFreeRequest
setupcl.dll
SclDelayLoadHook
base\ntsetup\opktools\sysprep\dlls\opk\spopk.cpp
SclDelayLoadHook:Could not get current DLL handle; dwRet = 0x%X
SclDelayLoadHook:Could not form module path; dwRet = 0x%X
SclDelayLoadHook:Could not build path to SetupCl library
UpgradeCleanup
SYSTEM\Setup
UpgradeGeneralize
Sysprep_Generalize_Opk
Sysprep_Generalize_Opk:Could not set HKLM\%s [%s]; dwRet = 0x%X
Sysprep_Generalize_Opk:Could not create SetupCl generalize request; HRESULT = 0x%X
Sysprep_Generalize_Opk:Could not pend SetupCl request; dwRet = 0x%X
Sysprep_Clean_Opk
Sysprep_Clean_Opk:Failed to remove Uninstall; dwRet = 0x%X
Sysprep_Clean_Opk:Could not clean system drive; hr = 0x%X
Upgrade
Sysprep_Clean_Opk:Failed to remove HKLM\%s [%s]; dwRet = 0x%X
Sysprep_Clean_Opk:Could not set HKLM\%s [%s]; dwRet = 0x%X
PrepareMachineForSysprepCleanup
SysprepCleanup
Sysprep_Clean_Opk:Unable to prepare reserves for sysprep; hr = 0x%X
Sysprep_Clean_Opk:Successfully prepared reserves for sysprep.
Sysprep_Clean_Opk:Unable to get address for PrepareMachineForSysprepCleanup; hr = 0x%X
Sysprep_Clean_opk:Couldn't get a reserve manager loader object. hr = 0x%X
Sysprep_Offline_Specialize_Opk
Sysprep_Offline_Specialize_Opk:Could not get volume path name for [%s]; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Volume path name [%s] is too long; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Could not get volume name for volume mount point [%s]; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Could not get pending SetupCl request; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Could not get runtime Windows directory; dwRet = 0x%X
SysprepMode
Microsoft\Windows\CurrentVersion\Setup\Sysprep
upgrade
Sysprep_Offline_Specialize_Opk:Could not get Sysprep mode; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Could not execute SetupCl request; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Could not pend SetupCl request; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Could not clear pended SetupCl request; dwRet = 0x%X
Sysprep_Offline_Specialize_Opk:Could not generate PathName value; HRESULT = 0x%X
Sysprep_Online_Specialize_Opk
Sysprep_Online_Specialize_Opk:Could not generate PathName value; HRESULT = 0x%X
Sysprep_Clean_Validate_Opk
Sysprep_Clean_Validate_Opk:Sysprep will run on an upgraded OS.
Sysprep
Sysprep_Clean_Validate_Opk:Failed to query pending CBS operations; hr = 0x%x
Sysprep_Clean_Validate_Opk:There are one or more Windows updates that require a reboot. To run Sysprep, reboot the computer and restart the application.
ValidateMachineForSysprep
SysprepValidate
Sysprep_Clean_Validate_Opk: Audit mode cannot be turned on if reserved storage is in use. An update or servicing operation may be using reserved storage.; hr = 0x%X
Sysprep_Clean_Validate_Opk: Successfully validated reserves state on the machine for entering audit mode.
Sysprep_Clean_Validate_Opk: Unable to get address for ValidateMachineforSysprep; hr = 0x%X
Sysprep_Clean_Validate_Opk: Couldn't get reserve manager. Error: 0x%X
RemoveUninstall
RemoveUninstall:Uninstall data was removed successfully
RemoveUninstall:Failure while calling RemoveUninstall; hr = 0x%x
RemoveUninstall:Uninstall no longer available
RemoveUninstall:Failed to instantiate uninstall interface; hr = 0x%x
SclLogCallback
[SetupCl library] %S
\\?\GLOBALROOT
\\?\Volume{
\\?\UNC
\Device\HarddiskVolume
\Device\Harddisk
Partition
\\?\UNC\
kernel32.dll
api-ms-win-core-file-l1-2-2.dll
FindFirstFileNameW
FindNextFileNameW
DeleteFileEx: Unable to verify path redirection on [%s]; GLE = 0x%x
DeleteFileEx: Unable to allocate hardlink path buffer
DeleteFileEx: Will not restore attributes on hardlinks of [%s]
DeleteFileEx: Unable to remove [%s]; GLE = 0x%x
DeleteFileEx: Trying to set back attributes on hardlink given: %s
DeleteFileEx: Unable to restore attributes on [%s]; GLE = 0x%x
DeleteFileEx: Unable to open [%s]; GLE = 0x%x
DeleteFileEx: Unable to clear out attributes on [%s]; GLE = 0x%x
DeleteFileEx: Unable to get information on [%s]; GLE = 0x%x
DeleteFileEx: Spoofing detected deleting [%s] -> [%s]
DeleteFileEx: Unable to delete [%s]; GLE = 0x%x
DeleteFileEx: Unable to prepare Unicode path for [%s]; GLE = 0x%x
DeleteFileEx: Unable to form long path name for [%s]; GLE = 0x%x
WdsRemoveDirectory: Unable to clear attributes on [%s]; GLE = 0x%x
WdsRemoveDirectory: Unable to remove directory [%s]; GLE = 0x%x
WdsRemoveDirectory: Unable to prepare path [%s]; GLE = 0x%x
\Device
Current
Select
SetupPlatform.dll
SetupPlatform::GetSetupPlatformVersion
base\ntsetup\setupplatform\lib\static\setupplatform.cpp
SetupPlatform::GetSetupPlatformVersion: Failed to build path to platform binary. hr = 0x%x
SetupPlatform::GetSetupPlatformVersion: Failed get file info for [%s]. hr = 0x%x
Sources
$WINDOWS.~BT
Windows.old
pGetUninstallInterfaceCommon
pGetUninstallInterfaceCommon: Failed loading the setupplatform, hr = 0x%x
_GetUninstallInterface
pGetUninstallInterfaceCommon: Failed getting the uninstall interface, hr = 0x%x
HKEY_LOCAL_MACHINE
RegValueEnumAction::Enumerate
base\ntsetup\setupplatform\lib\static\utilities.cpp
RegValueEnumAction::Enumerate: Failed to open key %s\%s (error %d)
RegValueEnumAction::Enumerate: Failed to query key info: %s\%s (error %d)
RegValueEnumAction::Enumerate: Error enumerating contents of key: %s\%s (error %d)
HiveListEnumerator::ConvertWin32PathToNt
QueryDosDevice failed for %s. GLE: %u
BuildPath failed for %s and %s. GLE: %u
HiveListEnumerator::UnloadHiveByNtPath
force-
Failed to %sunload hive loaded at [%s]. Error: 0x%08X
Could not get exclusive lock on hive file %s. Error: 0x%08X
Hive file %s is in use; will attempt retries to ensure it is unloaded.
System\CurrentControlSet\Control\hivelist
DirectoryHiveUnloader::ProcessValue
Force-unloading %s which is loaded from under %s
Hive unload failed; cancelling enumeration. GLE: %u
pUnloadMountedHives
Conversion to NT path failed for %s. Error: 0x%08X
Enumeration of hive list failed. Error: 0x%08X
pStopSetupPlatformETWSession
pStopSetupPlatformETWSession: Failure while querying all traces. Error: 0x%08X
Active tracing sessions:
  Session name: %s
    Log file name: %s
    Log file mode: 0x%08x
    Flush timer: %u
    Enable flags: 0x%08x
NT Kernel Logger
SP_DOWNLEVEL_UM_ETW_SESSION
SP_DOWNLEVEL_TELEMETRY_ETW_SESSION
Found relevant tracing session: name=[%s], logfilename=[%s]
\$windows.~bt\
pStopSetupPlatformETWSession: Failure while stopping trace at [%s]. Error: 0x%08X
SPCleanupInstallationDrive
SPCleanupInstallationDrive: Failure while building path to Setup Platform working directory. Error: 0x%08X
SPCleanupInstallationDrive: Cleaning up %s
SPCleanupInstallationDrive: Unable to unload mounted hives under %s. Error: 0x%08X
SPCleanupInstallationDrive: Unable to stop Setup Platform ETW session. Error: 0x%08X
SPCleanupInstallationDrive: Unable to stop Setup Platform monitoring driver. Error: 0x%08X
SafeOS.Mount
SafeOS
SPCleanupInstallationDrive: Failure while building path to safe OS mount directory. Error: 0x%08X
SPCleanupInstallationDrive: Unmounting directory %s
SPCleanupInstallationDrive: Unable to unmount the directory %s. Error: 0x%08X
SuspendedData
SYSTEM\Setup\SetupPlatform
SPCleanupInstallationDrive: Cleanup suspended data from registry keys
SPCleanupInstallationDrive: Failure to delete %s [%s]. Error: 0x%08X
SPCleanupInstallationDrive: Not suspended data in registry keys, no need for cleanup
SPWdslibLogCallback
SPExecuteCleanup
SPExecuteCleanup: Failure while building path to clean up file %s. Error: 0x%08X
SPExecuteCleanup: Failure while building path to clean up folder %s. Error: 0x%08X
SPExecuteCleanup: Cancelled
SPExecuteCleanup: Failure while enumerating folder %s. Error: 0x%08X
SPExecuteCleanup: Failure while removing folder %s. Error: 0x%08X
SPExecuteCleanupFailure while removing file %s. Error: 0x%08X
base\ntsetup\setupplatform\deployment\monitor\api\winsetupmonapi.cpp
SeBackupPrivilege
SeRestorePrivilege
CSystemHive::Unload
CSystemHive::Unload: Failed to unload system hive %s; hr = 0x%x
WsmGetCurrentControlSetKeyName
WsmGetCurrentControlSetKeyName: Failed to open system hive key %s; hr = 0x%x
WsmGetCurrentControlSetKeyName: Failed to get current control set value under hive key %s; hr = 0x%x
%s\ControlSet%03u
WsmGetCurrentControlSetKeyName: Failed to allocate current control set key path; hr = 0x%x
WsmGetCurrentControlSetKeyName: Failed to close system key; hr = 0x%x
WsmGetServiceKeyName
WsmGetServiceKeyName: Failed to get current control set key name under hive key %s; hr = 0x%x
Services\WinSetupMon
WsmGetServiceKeyName: Failed to build service key path; hr = 0x%x
WsmGetConfigKeyName
WsmGetConfigKeyName: Failed to get current control set key name under hive key %s; hr = 0x%x
Control\WinSetupMon
WsmGetConfigKeyName: Failed to build service key path; hr = 0x%x
%s\Setup\WinSetupMon
WsmGetConfigKeyNameLegacy
WsmGetConfigKeyNameLegacy: Failed to allocate config key path; hr = 0x%x
SYSTEM
ErrorControl
%WINDIR%\System32\drivers\WinSetupMon.sys
WsmUninstall
WsmUninstall: Failed to build driver file path; hr = 0x%x
WsmUninstall: Failed to reset error control value; hr = 0x%x
WsmUninstall: Failed to delete config key %s; hr = 0x%x
WsmUninstall: Failed to delete legacy config key %s; hr = 0x%x
WsmUninstall: Failed to determine whether driver is loaded; hr = 0x%x
WsmUninstall: Failed to close filter communication port, hr = 0x%08x
WsmUninstall: Failed to delete service key %s; hr = 0x%x
WsmUninstall: Failed to delete driver file %s; hr = 0x%x
WsmIsLoaded
WsmIsLoaded: Failed to allocate buffer; hr = 0x%x
WsmIsLoaded: Failed to allocate larger buffer; hr = 0x%x
WsmIsLoaded: Failed FilterFindFirst(); hr = 0x%x
WinSetupMon
Found %.*s loaded
  Number of instances: %u
  Frame ID: %u
WsmIsLoaded: Failed FilterFindNext(); hr = 0x%x
WsmIsLoaded: Failed FilterFindClose(); hr = 0x%x
SeLoadDriverPrivilege
WsmUnload
WsmUnload: Failed to close filter communication port, hr = 0x%08x
Filter %s not installed; nothing to unload
WsmUnload: Failed FilterUnload(); hr = 0x%x
Driver configuration does not exist after unload; uninstalling driver
WsmUnload: Failed to delete service key %s; hr = 0x%x
WsmUnload: Failed to delete driver file %s; hr = 0x%x
9d2e7c0f-6d3a-4d2e-b5ed-a6e837799661
Setup
System\Setup
CloneTag
SidsGenerated
SOFTWARE\Microsoft\Sysprep
SidsGeneratedHistory
PathName
Microsoft\Windows NT\CurrentVersion
SystemRoot
%WINDIR%
SOFTWARE\Microsoft\Windows NT\CurrentVersion
SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion
EnumeratePathEx: Unable to get reparse tag for persistent reparse point; GLE = 0x%x
EnumeratePathEx: Unable to enumerate [%s]; GLE = 0x%x
EnumeratePathEx: Callback requested enumeration interruption or hit internal enumeration failure on [%s]; GLE = 0x%x
EnumeratePathEx: Unable to construct path under [%s]; GLE = 0x%x
EnumeratePathEx: FindFirstFile failed for [%s]; GLE = 0x%x
EnumeratePathEx: Failed search path is >= MAX_PATH!
DeletePathDirectoryCallback: Spoofing detected deleting [%s] -> [%s]
<unavailable>
DeletePathEngine: Hit %u failure%s during recursive deletion of [%s]; 1st error = 0x%x, cd = [%s]
DeletePath: Cannot delete <null>.
DeletePath: [%s] doesn't exist as a directory; nothing to delete.
DeletePath: Failed to get desired paths for [%s] (GLE = 0x%x)
DeletePath:   Full path [%s]
DeletePath:   Long path [%s]
DeletePath:   Final path [%s]
DeletePath: Attempting to obliterate [%s] (final path [%s]).
DeletePath: Failed to obliterate [%s] (GLE = 0x%x); retrying...
DeletePath: Failed to obliterate [%s] after %u tries; GLE = 0x%x
spopk.pdb
.text$di
.text$mn
.text$mn$00
.text$x
.text$yd
.rdata$brc
.idata$5
.00cfg
.CRT$XCA
.CRT$XCU
.CRT$XCZ
.CRT$XIA
.CRT$XIAA
.CRT$XIZ
.gehcont
.gfids
.giats
.rdata
.rdata$r
.rdata$voltmd
.rdata$zzzdbg
.xdata
.didat$2
.didat$3
.didat$4
.didat$6
.didat$7
.edata
.idata$2
.idata$3
.idata$4
.idata$6
.data$rs$brc
.data
.pdata
.didat$5
.rsrc$01
.rsrc$02
SclFreeRequest
SclExecuteRequest
SclGetPendedRequest
SclPendRequest
SclClearPendedRequest
LoadUpdateReserveManager
spopk.dll
Sysprep_Clean_Opk
Sysprep_Clean_Validate_Opk
Sysprep_Generalize_Opk
Sysprep_Offline_Specialize_Opk
Sysprep_Online_Specialize_Opk
__CxxFrameHandler3
_wcsicmp
_purecall
_strnicmp
_stricmp
_XcptFilter
_amsg_exit
malloc
_initterm
__C_specific_handler
msvcrt.dll
?terminate@@YAXXZ
_lock
_unlock
__dllonexit
_onexit
RtlNtStatusToDosError
RtlCaptureContext
RtlLookupFunctionEntry
RtlVirtualUnwind
ntdll.dll
HeapFree
SetLastError
GetModuleHandleExW
GetVolumePathNameW
GetVolumeNameForVolumeMountPointW
GetLastError
GetProcAddress
GetProcessHeap
GetModuleHandleW
FreeLibrary
GetSystemWindowsDirectoryW
LoadLibraryExW
Sleep
UnhandledExceptionFilter
SetUnhandledExceptionFilter
GetCurrentProcess
TerminateProcess
QueryPerformanceCounter
GetCurrentProcessId
GetCurrentThreadId
GetSystemTimeAsFileTime
GetTickCount
KERNEL32.dll
CoCreateInstance
ole32.dll
WdsSetupLogMessageW
ConstructPartialMsgVW
CurrentIP
WDSCORE.dll
FilterFindNext
FilterUnload
FilterFindClose
FilterFindFirst
FLTLIB.DLL
WinVerifyTrust
WTHelperProvDataFromStateData
WTHelperGetProvSignerFromChain
WINTRUST.dll
CertVerifyCertificateChainPolicy
CRYPT32.dll
WIMUnmountImage
WIMGAPI.DLL
_vsnwprintf
wcschr
_wcsnicmp
wcsrchr
wcsncmp
_vsnprintf
_vscwprintf
wcsstr
towlower
_wctime
_callnewh
??1type_info@@UEAA@XZ
_errno
realloc
RtlAllocateHeap
RtlFreeHeap
NtSetInformationFile
RtlInitUnicodeString
NtUnloadKey2
NtOpenFile
NtClose
RegQueryValueExW
RegEnumValueW
RegDeleteValueW
RegOpenKeyExW
RegSetValueExW
RegDeleteTreeW
RegCreateKeyExW
RegCloseKey
RegQueryInfoKeyW
QueryAllTracesW
GetTraceLoggerHandle
StopTraceW
RegUnLoadKeyW
ADVAPI32.dll
CompareStringW
GetFullPathNameW
GetLongPathNameW
GetFinalPathNameByHandleW
GetModuleFileNameW
CreateFileW
CloseHandle
HeapAlloc
GetCurrentDirectoryW
ExpandEnvironmentStringsW
GetFileInformationByHandleEx
FindFirstFileW
FindNextFileW
DeviceIoControl
FindClose
GetFileAttributesW
SetFileAttributesW
GetFileInformationByHandle
SetFileInformationByHandle
DeleteFileW
WaitForSingleObject
GetWindowsDirectoryW
RaiseException
QueryDosDeviceW
VirtualProtect
LoadLibraryExA
ReleaseSRWLockExclusive
AcquireSRWLockExclusive
GetSystemInfo
VirtualQuery
OutputDebugStringA
OpenProcessToken
AdjustTokenPrivileges
LookupPrivilegeValueW
GetFileVersionInfoSizeExW
GetFileVersionInfoExW
VerQueryValueW
VERSION.dll
memcpy
memset
.?AV?$CAutoCleanupBase@PEAUtagVS_FIXEDFILEINFO@@@RAII@@
.?AV?$CAutoWdsLibFree@PEAUtagVS_FIXEDFILEINFO@@@RAII@@
.?AV?$CAutoCleanupBase@PEAG@RAII@@
.?AV?$CAutoWdsLibFree@PEAG@RAII@@
.?AV?$CAutoCleanupBase@PEAUHINSTANCE__@@@RAII@@
.?AVCAutoFreeLibrary@RAII@@
.?AV?$CAutoCleanupBase@PEAE@RAII@@
.?AV?$CAutoDeleteArray@E@RAII@@
.?AV?$CAutoCleanupBase@PEAPEAU_EVENT_TRACE_PROPERTIES@@@RAII@@
.?AV?$CAutoDeleteArray@PEAU_EVENT_TRACE_PROPERTIES@@@RAII@@
.?AV?$CAutoCleanupBase@PEBG@RAII@@
.?AV?$CAutoWdsLibFree@PEBG@RAII@@
.?AVDirectoryHiveUnloader@@
.?AVHiveListEnumerator@@
.?AVRegValueEnumAction@@
VS_VERSION_INFO
StringFileInfo
040904B0
CompanyName
Microsoft Corporation
FileDescription
OPK Sysprep Plugin
FileVersion
10.0.22621.1 (WinBuild.160101.0800)
InternalName
Spopk.dll
LegalCopyright
 Microsoft Corporation. All rights reserved.
OriginalFilename
SPOPK.DLL
ProductName
Microsoft
 Windows
 Operating System
ProductVersion
10.0.22621.1
VarFileInfo
Translation
