!This program cannot be run in DOS mode.
.text
`.rsrc
@.reloc
lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet
PADPADP
?a#e3
'Iii)
w/,tK0,o
00j"2
A7W^B
6Es6kF
U|LGVY
}H\3[
AdBasedAuthenticationFailure
AdDomainTrust
AdGroupMembership
AdministrativeHttpsConnectionFailed
AnalyzingEnvironment
AnalyzingResults
AppPoolUserNeedsReadAccess
AttestationCertificatePermissions
AttestationClientNotUsingHttps
AttestationClientWrongUrl
AttestationHttpsUrlConfiguration
AttestationMissingHttpsCertificate
AttestationServerCertificateValid
AttestationServiceIpsMatchServer
AttestationServiceResponds
AttestationServiceUrlMismatch
AttestationSignerExpired
AttestationSignerNotRegisteredOrEnabled
AttestationSigningCertificatesNotExpired
AttestationSigningCertificatesRegistered
AttestationUrlAvailable
AttestationUrlNotSet
AttestationUrlShouldNotMatchFallback
AttestationUrlUsesHostname
AuthenticationFailure
BadSecureBootSettings
BaseVirtualizationAvailable
BaseVirtualizationRequiredButNotAvailable
BaseVirtualizationSupportNotAvailable
BaselinePoliciesInstalled
BestPractices
BitlockerPolicy
CannotCommunicateWithHgs
CannotRetrieveDACL
Certificates
CheckAttestationStatus
CheckAttestationUrlConfiguration
CheckKpsUrlConfiguration
CheckMemoryUsage
CheckProvisionedMemory
CiPolicyActive
CiPolicyChangedButNotActive
CiPolicyInstalled
CiPolicyNotActive
CiPolicyNotFoundOnServer
ClientConfigurationSet
ClientDidNotFullBoot
ClientDoesNotSupportGpresult
ClientInLocalMode
ClientInLocalModeRare
ClientsShareUrls
CodeIntegrityPoliciesInstalled
CollectingRemoteTraces
CollectingTracesRemotely
CollectorFailedVerification
CollectorNeverRan
CollectorNotAvailable
ConnectingToTarget
CouldNotRetrieveProcessInfo
DebugOutputCancelled
DevRemoteProcessInfo
DeviceGuard
DeviceGuardHasRequiredFeatures
DeviceGuardProviderNotFound
DeviceGuardRequiredFeaturesPresent
DiagnosticNamesNotValid
DiagnosticRequiresMoreTargets
DiagnosticSkippedDueToFallbackUsed
DiagnosticsCannotBeRunSimultaneously
DifferentHttpsCertificates
DmaProtectionRequiredButNotAvailable
DnsResolvesMultipleNames
DnsResolvesNames
DnsServerIpAddressIsMeta
DnsServerReachable
DnsServerResolvesToWrongIp
DnsServerUnreachable
DnsServersResolveNameDifferently
DumpEncryption
DumpEncryptionKey
DumpsEnabled
DuplicateTarget
DuplicateTracesFound
ErrorRetrievingCertificatePermissions
ExecutingCollector
ExecutingCollectorOn
ExecutingCollectorUsing
ExecutingCollectorUsingOn
ExecutingDiagnostic
ExecutingSynthesizer
ExtraAttestationUrls
ExtraKeyProtectionUrls
FailedToAcquirePrivateKeyHandle
FailedToReadUefiVariable
FailedToRetrieveIISAppPoolIdentity
FailureInMachine
FallbackAttestationFailed
FallbackAttestationPasses
FallbackKpsResponds
FallbackNotApplicableInNonSHS
FallbackUrlMatchesPrimary
FullBoot
GetTraceChunkUnexpectedResultCount
GetTraceLengthUnexpectedResultCount
GetTraceNotEnoughMemory
GetTraceStartByteNegative
GetTraceStartByteTooHigh
GetTraceUnexpectedWsManResultCount
GroupsAuthorized
GuardedFabric
GuardedFabricSet
HTTPS
Hardware
HgsFallback
HgsServersReachable
HibernationEnabled
HostGuardianServiceClientDomainNotTrusted
HostGuardianServiceClientGroupsNotPresentInStore
HostGuardianServiceClientSecureBootInstalledButNotEnabled
HostGuardianServiceClientSecureBootNotInstalled
HostGuardianServiceServerHighMemoryUsage
HostGuardianServiceServerInsufficientMemory
HostNameTypeNotDns
HostNameTypeNotDnsSkipped
HostNotConfiguredForFallback
HostUnauthorizedAD
HostUnauthorizedTPM
HostUnreachable
HostnameEmptyOrNull
HostnameInvalid
HostsAuthorized
HttpsCertificateShared
HttpsConnectionFailed
HvciPolicy
IdkMissingFromTcgLog
InsufficientTpmVersion
InvalidUrlConfigurationAts
InvalidUrlConfigurationIp
InvalidUrlConfigurationKps
IommuPolicy
KeyProtectionAdministrationCertificateValidation
KeyProtectionClientNotUsingHttps
KeyProtectionClientWrongUrl
KeyProtectionMissingHttpsCertificate
KeyProtectionServerCertificateValid
KeyProtectionServiceIpsMatchServer
KeyProtectionServiceUrlMismatch
KeyProtectionUrlNotSet
KeyProtectionUrlShouldNotMatchFallback
KeyProtectionUrlUsesHostname
KpsCertificatePermissions
KpsHttpsUrlConfiguration
KpsResponds
KpsUrlAvailable
LocalMode
LoopbackAddress
MalformedUrlBlocking
ManifestEntryFileNotFound
ManifestEntryNotFound
ManifestInvalid
ManifestNotFound
ManifestVersionUnsupported
MissingAttestationUrls
MissingCertificate
MissingCertificates
MissingKeyProtectionUrls
ModeUnknownQuestionableRelevance
NamesResolveIdentically
NamesResolveIdenticallyOnAllHosts
NamesResolveToServerIps
Network
NoApplicableFeatures
NoAttestationServersAvailable
NoAuthorizedHostGroups
NoAuthorizedHosts
NoBaselinePoliciesOnServer
NoCiPolicyFound
NoCodeIntegrityPoliciesOnServer
NoDiagnosticsExecuted
NoDnsServers
NoDnsServersReachable
NoFullBoot
NoIpstoTest
NoKeyProtectionServersAvailable
NoMatchingIpsFoundClientUrl
NoPrivateKey
NoRequiredSecurityFeatures
NoSecureBoot
NoTpmPresent
NoUrlsConfigured
NotAllDiagnosticsExecuted
NotAllSigningCertificatesRegisteredExceptCurrent
OneOrMoreResolutionsFail
OtherNameResolutionIssueBlocking
OverallResult
PagefileEncryptionPolicy
PhysicalMemoryDiagnostics
PolicyNotLoaded
PreparingForExecution
Prerequisites
PrivateKeyContainerNotFound
RemoteCollectionUnexpectedResultCount
RemoteCollectorRunOnUnsupportedTarget
RemoteCollectorUnexpectedVerificationFailure
RemoteTraceDownloadStatus
RemoveDuplicateTraces
RequiredDeviceGuardFeaturesNotAvailable
RequiredDiagnosticsNotScheduled
RequiredFeaturesInstalled
RequiredTpmNotFound
ResolvesNameDifferentlyThanOtherHosts
ResolvingDnsIssues
ResultsInvalid
Running
SecureBoot
SecureBootRequiredButNotAvailable
SecurityInfoError
ServerCannotResolve
ServerCannotResolveToMultipleAddresses
ServerConfigurationSet
ServerTargetOsUnsupported
ServiceError
ServiceHttpError
ServiceNotConfigured
ServiceNotFound
ServiceUnreachable
SetupModeUEFI
ShouldUseRoundRobin
SimulateADAttestation
SimulateTpmAttestation
StaleKerberosTicket
StaleTicketProbable
SwitchToADMode
TargetCouldNotAuthenticate
TargetCouldNotBeReached
TargetDoesNotSupportRemoteAccess
TargetMetadataVersionUnsupported
TargetMissingCmdlet
TargetUnknownConnectionException
TargetValidationFailed
TargetVersionUnspported
TcgLogVerificationFailed
TestAttestation
TpmError
TpmPresence
TpmVersion
TraceCollectorsNotFound
TraceDiagnosticsNotFound
TraceDirectoryNotFound
TracesCollectedOnDifferentVersions
TracesStorageLocation
TracesUnsupported
UEFIisNotPresentOrInSetupMode
UefiInvalidState
UnknownHostNameTypeRequireDNS
UnknownHostNameTypeRequireIP
UnknownInsecureHost
UnknownTransient
UnrecognizedIpResolved
UnrecommendedHostnameConfiguration
UnrelatedError
UnsupportedAccessControlEntry
ValidateAttestationHttpsCertificate
ValidateBootLogAgainstPolicy
ValidateKeyProtectionHttpsCertificate
VbsConfiguredAndRunning
VbsConfiguredButNotRunning
VbsNotConfiguredNotRunning
VbsStateUnknown
VerboseTargetCreationWithRole
VerboseTargetDiscovered
VerboseTotalFoundCollectors
VerboseTotalFoundDiagnosticSets
VsmIdkMissing
VsmNotFound
WarningPreExistingTraces
WmiNotFound
Host failed to authenticate to the attestation service.  This host's domain may not be trusted by the HGS domain, preventing kerberos or NTLM authentication from succeeding.
Domain Trust
 Authorized Host Group Membership
An HTTPS connection to the KPS administration API failed.  This usually means that the certificate used for SSL is not trusted by the server itself.
Analyzing Environment
Analyzing results...
iThe user "{0}" must have read permissions to the certificate with the subject "{1}" and thumbprint "{2}".
#Attestation Certificate Permissions
LAll attestation servers are HTTPS-enabled but {0} is configured to use HTTP.
`The attestation client is configured to use the URL "{0}" but the server is configured at "{1}".
#Attestation HTTPS URL Configuration
nThe attestation server is configured to use the URL "{0}" but no HTTPS certificates were found matching "{1}".
+Attestation Server Certificate Verification
*Attestation Service IP's Match Server IP's
(Attestation Service Responds to Requests
Your clients use different attestation service URL's.  Use Set-HgsClientConfiguration to correct the service URL configuration.
The attestation signing certificate with the subject "{0}" and thumbprint "{1}" is expired.  Register a valid certificate with both the attestation and key protection services to ensure hosts will be able to boot shielded VM's.
The attestation signing certificate with the subject "{0}" and thumbprint "{1}" is not registered with the Key Protection Service or has been disabled.  Use Add-HgsKeyProtectionAttestationSignerCertificate to register the certificate.
&Attestation Signing Certificates Valid
+Attestation Signing Certificates Registered
Attestation URL Available
 Attestation Service URL not set.
=Primary Attestation URL Differs From Fallback Attestation URL
+Attestation Service URL's uses DNS Hostname
Host failed to authenticate to the attestation service.  Verify that HTTPS is configured correctly.  If your HGS server is configured to use Active Directory-based attestation, ensure that this host's domain is trusted by the HGS domain and that the trust is valid.
The host uses secure boot settings (UEFI variables DB and DBX) that are not recognized by the attestation service.  Ensure that the secure boot variables have not changed and that a baseline policy with the latest secure boot settings is registered on the server.
%Base Virtualization Support Available
Base Virtualization Support was configured to be required for Device Guard, but not available on this host.  This is a hardware dependent feature that allows a processor to support Second Level Address Translation, or SLAT, and is required for any virtualization via Hyper-V, including shielded VMs.
eThis host does not support virtualization via Hyper-V, which is imperative for running a shielded VM.
Baseline Policies Installed
Best Practices
cThe remote attestation request for this host failed because it did not start with BitLocker enabled
The host cannot connect to the HGS server at {0}.  Verify that the network is operating correctly and that no firewalls are blocking the ports you have configured for HGS communication.
%Unable to retrieve discretionary ACL.
Certificates
Check Attestation Status
$Attestation Server URL Configuration
'Key Protection Server URL Configuration
Memory Usage
Provisioned Memory
Code Integrity Policy Active
The code integrity policy currently installed does not match the policy recorded at boot time.  Restart the system to finish activating the new policy.
Code Integrity Policy Installed
The code integrity policy has been installed but is not active.  You must restart the host after installing or updating the policy.
The host's code integrity policy is not present or not recognized by the server.  Ensure a policy has been installed, the host has been restarted, and the policy is registered on the server with the Add-HgsAttestationCIPolicy command.
HGS Client Configuration
pThe host woke from sleep/hibernation and did not cold boot.  A full boot is required for attestation to succeed.
OThe host "{0}" was not tested because it does not support the gpresult command.
The host is currently configured in local mode.  To use with an HGS cluster, specify service URL's using the Set-HgsClientConfiguration command.
The client is currently configured in local mode.  In most cases this is unintentional and you should properly configure the client to use a Host Guardian Service cluster with Set-HgsClientConfiguration.  If this was done on purpose, it is safe to ignore this warning.
Share the Same Service URL's
!Code Integrity Policies Installed
Collecting remote traces...
Collecting Traces Remotely
The collector did not pass verification despite reporting success.  This can indicate a version mismatch between the trace file and the diagnostic module.
NThe collector was not run on "{0}" when the pre-provided traces were gathered.
The collector was not found.  Ensure the name was typed correctly.  This can also indicate that hosts are using different versions of diagnostics and some lack this particular collector.  It is safe to ignore this result if you intend to run different versions of diagnostics across your fabric.  Otherwise, update all hosts to the same version and try again.
Connecting to {0}...
Attempted to retrieve information about the host process but failed.  Process will continue like normal but the host process will still wait for a debugger to attach as requested.
 Output processing was cancelled.
The host "{0}" will have its remote session hosted in the process ({1}:{2}) and wait for a debugger to attach before proceeding.
Device Guard
"Device Guard Has Required Features
OThe diagnostic did not run because the Device Guard WMI provider was not found.
&Device Guard Required Features Present
@Diagnostics must be a valid list of diagnostic collection names.
5{0} requires additional targets.  Missing roles: {1}.
The diagnostic did not run on the host {0} as it used its fallback attestation URL to attest. Fallback only occurs when there is an issue communicating with the primary HGS instance. Other diagnostics may contain indicators of the underlying problem.
T{0} cannot be executed simultaneously.  Specify only one of the above and try again.
{Not all servers share the same HTTPS certificate.  This is not recommended and can increase the complexity of managing HGS.
DMA Protection was configured to be required for Device Guard, but not available on this host.  Also known as IOMMU, this is a hardware dependent feature prevents direct memory attacks.
/Resolves Service Hostname to Multiple Addresses
Resolves Service Hostname
The non-routable meta IP address '{0}' is listed as a DNS Server for the interfaces with the following indexes: {1}.  This is usually evidence of an unknown or invalid configuration; if this was intentional, you may safely ignore this warning as long as some DNS server on the host can resolve the service name. 
DNS Servers Reachable
cThe DNS server at {0} used by {1} resolved {2} to IP addresses not associated with an HGS node: {3}
DNS server at {0} could not be contacted within the time allotted by the DNS client; this server cannot be used to resolve names.
Not all DNS servers resolve {0} to the same set of IP addresses.  This can indicate that the DNS configuration on this host or the host's network is correct.  Verify DNS is configured appropriately.
The remote attestation request failed because the host started with dump encryption disabled. For help, refer to  http://go.microsoft.com/fwlink/?LinkId=824149
The remote attestation request failed because the host&apos;s dump encryption key protector did not match a configured policy. For help, refer to http://go.microsoft.com/fwlink/?LinkId=824149
The remote attestation request failed because the host started with dumps enabled. For help, refer to http://go.microsoft.com/fwlink/?LinkId=824148
9A duplicate of '{0}' was provided and has been discarded.
@Multiple folders were found containing traces for the host "{0}"
rThere was an error retrieving the permissions for the certificate with the subject "{0}" and thumbprint "{1}": {2}
Collecting traces
Collecting traces on {0}
Collecting traces using {0}
"Collecting traces using {0} on {1}
 Executing diagnostics {0} on {1}
$Synthesizing traces using {0} on {1}
Z{0} is configured to use additional attestation URL's not found on other HGS servers: {1}.
{0} is configured to use additional key protection URL's not found on other HGS servers: {1}.  It is recommended that all servers use the same set of URL's.
Could not acquire private key information for certificate with thumbprint "{0}" and subject "{1}".  This can indicate the certificate lacks the required private key or the private key is stored using a special key storage provider such as a hardware security module.  Ensure the certificate has been properly imported with a private key and that the underlying key storage provider is working correctly if the key is not stored in the standard Microsoft Software Key Storage Provider.  If all of the above requirements are met, then the key may function correctly with the Host Guardian Service but this cannot be confirmed using this version of diagnostics.  If there is a newer version available in a newer edition of Windows or via Windows Update, it may be able to handle this key type.  Specific error: "{2}"
Could not read the UEFI variable "{0}".  This usually indicates a lack of administrator privileges or a host that utilizes a legacy BIOS.  If you have sufficient privileges and are on a UEFI-enabled host, verify you have the latest version of the manufacturer's firmware and drivers.  You may need to run this locally if the cmdlet was called remotely.
Failed to retrieve the identity of the IIS application pool "{0}".  Ensure HGS has been installed and initialized successfully.
Test failures in host "{0}":
AThe forced attestation request on the fallback URL '{0}' failed. 
"Fallback Attestation Requests Pass
4Fallback Key Protection Service Responds to Requests
qThe diagnostic was not run because fallback is not applicable in HGS Client modes other than HostGuardianService.
The fallback URL '{0}' is identical to its corresponding primary URL. This is not a useful practice, as the fallback HGS server is only contacted when there are connectivity issues reaching the primary, and thus the fallback attempt will face similar issues.
Full Boot
?Expected 1 result when fetching trace file chunk, received {0}.
@Expected 1 result when fetching trace file length, received {0}.
4Not enough memory available to open the file stream.
#Starting byte must be non-negative.
$Starting byte must be less than {0}.
PExpected only 1 result when querying for maximum memory per shell, received {0}.
Authorized Host Groups Added
Guarded Fabric
Fabric-wide Diagnostics
HTTPS
Hardware
HGS Client Fallback
HGS Servers Reachable
The remote attestation request failed because the host started with hibernation enabled. For help, refer to http://go.microsoft.com/fwlink/?LinkId=824147
The Host Guardian Service is not set up to trust the domain "{0}", to which the client machine "{1}" is joined.  Active Directory-based attestation will fail for this machine.
None of the groups that the host "{0}" is a member of are present in the Host Guardian Service policy store.  Active Directory-based attestation will fail for this machine.
CThe client is capable of Secure Boot, but does not have it enabled.
The client is not capable of performing a Secure Boot.  Check if the hardware meets UEFI Specifications Version 2.3.1, Errata C or higher, and is a UEFI Computer.
The server is using a high percentage of its memory, this can cause some requests to fail unexpectedly as the Host Guardian Service will refuse to start.  Memory usage must not exceed 95% and it is recommended that it should be less than 90%, actual usage is {0}%.
sThe server has been provisioned with very little memory ({0} GB).  It is recommended that hosts have at least 2 GB.
The service URL's specified an invalid host name "{0}".  The host name must be a valid, registered DNS name to run this diagnostic.
The service URL's specified a host name "{0}" that is not a valid, registered DNS name.  This diagnostic only applies to service URL's which use DNS names.
]This diagnostic did not run on this host because it has not configured a fallback HGS server.
Host is not authorized to use HGS.  Ensure the host is a member of an authorized host group registered on the server with the Add-HgsAttestationHostGroup command and that a fresh Kerberos ticket has been granted with the new membership.  (Have you restarted this host since updating its group memberships?)
Host is not authorized to use HGS.  Ensure the host has been authorized using the Add-HgsAttestationTpmHost command on the server.
Attestation failed because the host could not communicate with the HGS cluster.  Verify that the cluster is fully operational and can be reached on the appropriate HTTP/HTTPS ports.
-A hostname cannot be an empty or null string.
qThe argument is not a valid hostname. Supported hostnames included DNS names, IPv4 addresses, and IPv6 addresses.
Authorized Hosts Added
(HTTPS Certificates Shared Across Cluster
An HTTPS connection could not be opened to the server.  This usually means that the HTTPS certificate is not trusted and cannot pass validation.
The remote attestation request for this host failed because code integrity was not required by the hypervisor. Verify that code integrity is enabled and that it is being enforced by the hypervisor. For help, refer to http://go.microsoft.com/fwlink/?LinkId=734841
The Virtual Secure Mode identity key was not found in the measured boot log.  Ensure the Isolated User Mode feature has been enabled, the system has restarted at least once since that time, and that no tampering with the key data has occurred.
|The TPM on this host is version {0}.  Using TPM-based attestation with the Host Guardian Service requires a version 2.0 TPM.
{This diagnostic did not run on the host "{0}" because the attestation service URL "{1}" does not use a registered DNS name.
fThis diagnostic only applies when service URL's are configured with IP addresses instead of DNS names.
~This diagnostic did not run on the host "{0}" because the key protection service URL "{1}" does not use a registered DNS name.
The remote attestation request for this host failed because IOMMU was not required by the hypervisor. Verify that IOMMU is enabled and that it is explicitly required for Virtual Secure Mode to launch. For help, refer to http://go.microsoft.com/fwlink/?LinkId=734842
4Key Protection Administration Certificate Validation
OAll key protection servers are HTTPS-enabled but {0} is configured to use HTTP.
cThe key protection client is configured to use the URL "{0}" but the server is configured at "{1}".
qThe key protection server is configured to use the URL "{0}" but no HTTPS certificates were found matching "{1}".
.Key Protection Server Certificate Verification
-Key Protection Service IP's Match Server IP's
Your clients use different key protection service URL's.  Use Set-HgsClientConfiguration to correct the service URL configuration.
#Key Protection Service URL not set.
CPrimary Key Protection URL Differs From Fallback Key Protection URL
.Key Protection Service URL's uses DNS Hostname
KPS Certificate Permissions
&Key Protection HTTPS URL Configuration
+Key Protection Service Responds to Requests
$Key Protection Service URL Available
Local Mode
The guarded host {0} is configured to use a loopback address in its service URL's.  This may function in demo or proof-of-concept environments but should never be used under normal circumstances.
"{0}" is a malformed URL.
"{0}" could not be found.
%"{0}" was not found in this manifest.
$This is not a valid traces manifest.
'A manifest could not be found at "{0}".
The trace manifest version {0} is unsupported.  This version of diagnostics can only read version 1.0.0.0 manifests.  Regenerate the traces with a supported version of diagnostics and try again.
{0} is missing attestation URL's not found on other HGS servers: {1}.  It is recommended that all servers use the same set of URL's.
The IIS binding for "{0}" has no certificate associated with it that could be found.  This will cause HTTPS connections to fail, and can be caused by deleting certificates from the certificate store without updating the corresponding binding.
!Bindings without SSL Certificates
{0} is missing key protection URL's found on other HGS servers: {1}.  It is recommended that all servers use the same set of URL's.
The operating mode of the attestation client is unknown, thus this result may be unreliable.  Correct any communication problems between the host and the Host Guardian Service to determine the actual operation mode.
5Service Hostname Resolves the Same on All DNS Servers
/Service Hostname Resolves the Same on All Hosts
&Service Hostname Resolves to Server IP
Network
This host is neither a guarded host nor a Host Guardian Service node.  Install one of the above features to diagnose this host.
No attestation servers are configured to use the URL "{0}" requested by {1}.  This host may still function, but it is recommended to use the service URL's included in the results of Get-HgsServer.
rNo host groups have been authorized.  A host group must be authorized before its members can complete attestation.
]No hosts have been authorized.  A host must be authorized before it can complete attestation.
No baseline policies are registered on the server.  You must register and enable a baseline policy or attestation will never pass.
No code integrity policy was found.  Attestation will fail unless a code integrity policy is installed and active, and also registered on the server.
No code integrity policies are registered on the server.  You must register and enable a code integrity policy or attestation will never pass.
mNone of the provided targets satisfy the prerequisites for any diagnostics.  No diagnostics will be executed.
.Host does not have any DNS servers configured.
gNo DNS servers were reachable.  Host will be unable to resolve any names including the HGS service URL.
The host did not full boot, meaning that it has been put to sleep or hibernated since the last full restart.  Please restart the host.
INo IP's could be found to test.  Check DNS and service URL configuration.
No key protection servers are configured to use the URL "{0}" requested by {1}.  This host may still function, but it is recommended to use the service URL's included in the results of Get-HgsServer.
The guarded host {0} is configured to reach the URL "{1}", but no HGS servers are configured with that IP address.  You may not have specified all HGS nodes when running diagnostics or there is truly no server configured at that address.
The certificate with subject "{0}" and thumbprint "{1}" has no private key.  A private key is required for this certificate to function.  This can happen when the first HGS server has been initialized using certificate thumbprints.  Manually replicate the entire certificate, including the private key, to this HGS node and try again.
There are no required security features for Device Guard configured.  This can lead to insecurities in Virtualization Based Security, even if it is running.
YThe host does not have secure boot enabled.  This is required for attestation to succeed.
The host does not have a TPM.
!No service URL's were configured.
6Not all of the requested diagnostics will be executed.
The certificate used for signing new health certificates is registered and valid, however the certificates listed above may have been used to sign existing health certificates causing guarded hosts with cached health certificates to fail.  Register the above certificates with KPS or have new health certificates issued to all guarded hosts.
One or more DNS servers cannot resolve the HGS host name.  This can cause HGS requests to fail intermittently even if some of the DNS servers can resolve the name.
fAnother issue with name resolution prevented this diagnostic from finishing.  Check the other results.
Overall Result
oThe remote attestation request for this host failed because it did not start with page file encryption enabled.
Physical Memory Diagnostics
The Attestation policy could not be loaded from the exported attestation state. This can occur when no policies have been configured on the HGS server.  Add baseline and/or code integrity policies and try again.
Preparing for execution...
Prerequisites
The private key container for the certificate with thumbprint {0} could not be found.  This could be caused by using a different key storage provider or even a hardware security module.
CExpected 1 result when executing collectors remotely, received {0}.
KA remote collector was run against a target that does not support remoting.
A remote collector failed verification unexpectedly.  Remote collectors should verify successfully if remote collection did not return a failure.
Downloading {0}
*Remove all duplicate traces and try again.
Due to the unavailability of the aforementioned required Device Guard security features, Virtualization Based Security will be unable to run.  This may prevent a successful attestation, and will stop any shielded VMs from starting.
rThe selected diagnostics could not run components required to proceed.  Provide any missing targets and try again.
Required Features Installed
IA supported TPM is required to run this diagnostic and one was not found.
The host "{0}" resolves {1} to a different set of IP addresses than the other hosts.  This is not a recommended practice and could mean some hosts will not have access to the entire HGS cluster.
Resolve any networking and/or configuration problems with this host's DNS servers to repair name resolution.  Host must be able to communicate with DNS servers on port 53 within 8 seconds in order to resolve names.
;The generated result set is invalid and cannot be unpacked.
Running...
Secure Boot
Secure Boot was configured to be required for Device Guard, but not available on this host.  This is a UEFI dependent feature that validates the boot path, and ensures that the host boots using only firmware trusted by the manufacturer.
9Hit error {0} while getting security info for {1} on {2}.
'DNS server at {0} cannot resolve "{1}".
DNS server at {0} cannot resolve "{1}" to multiple IP addresses.  The recommended configuration is to have multiple HGS servers available at "{1}" for high availability.
HGS Service Configuration
MTargets running Windows Server Nano may not be Host Guardian Service servers.
uAn error (0x{0:X}) was returned while attempting to communicate with the service.  Status could not be verified: {1}.
Received HTTP error code {0} while attempting to communicate with the service.  Verify the URL was entered correctly and that the server is operating correctly.
HGS client has not been configured yet.  Use Set-HgsClientConfiguration to provide the key protection and attestation service URL's.
The service could not be found at the configured URL.  Verify the URL was entered correctly and that the server is operating correctly.
Attestation failed because the service could not be reached, however the host could be contacted.  Verify that the HGS service is running correctly and that the service URL's configured are correct.
UEFI Setup Mode
One or more DNS servers cannot resolve the HGS host name to multiple IP's.  This indicates that clients are not utilizing DNS round-robin to balance requests across the HGS cluster or that the cluster only contains a single node.  It is recommended that your HGS cluster contains 3 or more nodes and that clients utilize a round-robin DNS entry to communicate with the server.
Simulate AD-based Attestation
Simulate TPM-based Attestation
Stale Kerberos Ticket
The host was found to be a member of an authorized group but attestation reports that the host is unauthorized.  This usually indicates that this host is using a stale Kerberos ticket.  Please restart the host and try again.
Switch to AD Mode
'Unable to authenticate as {0} to "{1}".
Could not reach target "{0}".
EOpening a runspace to a target with access disabled is not supported.
The target metadata format is unsupported.  This version of diagnostics can only read version 1.0.0.0 target metadata.  Regenerate the traces with a supported version of diagnostics and try again.
%Could not access {0} cmdlet on "{1}".
=An exception occurred while opening a connection to {0}:
0Target validation failed on some or all targets.
oTarget "{0}" is running version {1} of the HGS diagnostics module.  This version only supports version 1.0.0.0.
The host cannot attest because it's TCG log cannot be verified.  This can indicate a problem with the system's firmware, the TPM itself, or other hardware components.  In some cases, this can be caused by utilizing an out-of-date Net Boot Program (NBP) and configuring the host to attempt PXE boot first.  If this is the case, update any PXE boot servers on your network (such as WDS) to use an updated NBP.
Test Attestation
A TPM error occurred during attestation.  This means there was an issue completing a remote TPM request, typically indicating that there is a problem with the host's TPM module and associated BIOS settings.  Validate the TPM is fully provisioned and operational.
TPM Presence
TPM Version
No requested collectors found.
#No requested diagnostic sets found.
A trace directory for target "{0}" was not found at "{1}".  Targets that cannot be accessed must have their traces pre-populated.
Pre-existing traces were found for target "{0}" that were gathered with version {1}, however the target is currently version {2}.  Regather the traces using the current version and try again.
!Traces have been stored at "{0}".
Trace files were collected at an unsupported version ({0}).  Recollect the traces using a supported version of diagnostics and try again.
EThe machine either does not use UEFI, or UEFI is still in setup mode.
UEFI reported secure boot is enabled and setup mode is also active.  This is an invalid state and should not be possible.  This indicates a problem with your system's firmware, drivers, or an underlying hardware problem.
This diagnostic did not run on the host {0} as the type of the URL "{1}" could not be discerned, and a DNS address is required.  Correct the service URL to be a valid URI with a registered name in the authority and try again.
This diagnostic did not run on the host {0} as the type of the URL "{1}" could not be discerned, and an IP address is required.  Correct the service URLto be a valid URI and try again.
Attestation evaluated this host as insecure but did not provide any additional information.  This is frequently caused by failing to configure any attestation policies with the Host Guardian Service.  Other diagnostics may be able to identify the root cause.
Attestation failed for an unknown reason and no additional information was provided.  This usually means that the service could not be reached or an attempt could never be made.  Other diagnostics that test the client and network may reveal the root cause.
You may not have specified all HGS nodes when running diagnostics, or your DNS infrastructure is not configured correctly.  It is recommended that you use a forwarder on your DNS server so that HGS can resolve the hostnames to all HGS cluster nodes automatically.
The service URL {0} specifies a hostname which is not a valid, registered DNS name.  The use of DNS names is recommended to enable more secure kerberos authentication and high availability.
 An unrelated error occurred: {0}
The format of the access control entry is not supported by this version of diagnostics.  Unable to validate the permissions assigned to the object.
3Attestation Server Certificate Subject Verification
 Validate Boot Log Against Policy
6Key Protection Server Certificate Subject Verification
4Virtualization Based Security Configured and Running
Device Guard Virtualization Based Security is configured on this host, but not running.  This can be caused by a Group Policy Object, and will cause this host to fail attestation.
Device Guard Virtualization Based Security is not configured or running on this host, which will stop any shielded VMs from starting.  This can be caused by a Group Policy Object, or a required Device Guard security feature missing.
The state of Device Guard Virtualization Based Security is currently unknown to HGS Diagnostics, as the version of Device Guard is newer than diagnostics.
,Creating a target with aggregate role "{0}".
"{0}" was discovered.
 Found a total of {0} collectors.
%Found a total of {0} diagnostic sets.
Valid VSM IDK Detected at Boot
The host cannot attest because virtual secure mode could not be detected.  Please ensure that the Isolated User Mode feature is installed and enabled, and that this is a physical machine (not a virtual machine).
Pre-existing traces were found at the path provided.  These will be reused; if you want new traces to be gathered, please provide a different path.
Could not locate a WMI class "{0}".  This could indicate that WMI is not installed and running on the host or that the WMI repository is corrupted.
v4.0.30319
#Strings
#GUID
#Blob
<Module>
Microsoft.Windows.HostGuardianService.Diagnostics.Payload.resources
Microsoft.Windows.HostGuardianService.Diagnostics.Payload.Strings.en.resources
Microsoft.Windows.HostGuardianService.Diagnostics.Payload.resources.dll
_CorDllMain
mscoree.dll
VS_VERSION_INFO
VarFileInfo
Translation
StringFileInfo
040904b0
CompanyName
Microsoft Corporation
FileDescription
FileVersion
10.0.22621.1
InternalName
Microsoft.Windows.HostGuardianService.Diagnostics.Payload.resources.dll
LegalCopyright
Copyright (c) Microsoft Corporation. All rights reserved.
OriginalFilename
Microsoft.Windows.HostGuardianService.Diagnostics.Payload.resources.dll
ProductName
Microsoft (R) Windows (R) Operating System
ProductVersion
10.0.22621.1
