!This program cannot be run in DOS mode.
@?Rich_
.text
h.rdata
H.data
.pdata
H.idata
HPAGE
`fothk
`INIT
bGFIDS
B.rsrc
B.reloc
L$ SVWAVH
8A^_^[
x AVH
tOH9x8uI9x
WAVAWH
0A_A^_
\$ UVWATAUAVAWH
`A_A^A]A\_^]
x ATAVAWH
@A_A^A\
x ATAVAWH
 A_A^A\
t$ UWAVH
R$fA;Z*
L$@H3
VWAVH
@A^_^
L$ SVWH
H USWH
s WAVAWH
TsFsL
 A_A^_
WATAVH
@A^A\_
UVWAVAWH
L!|$hH
D$hE3
0A_A^_^]
p WAVAWH
0A_A^_
UVWATAUAVAWH
@A_A^A]A\_^]
UVWAVAWH
H!\$`L
0A_A^_^]
WATAUAVAWH
T$xE3
 A_A^A]A\_
x AVH
TsFsH
UWATAVAWH
E@H;E
E@H;E
A_A^A\_]
H;D$@~
x AVH
I+N0H
@USVWATAUAVAWH
D$ E3
EwH!]wA
D$ E3
A_A^A]A\_^[]
VWAVH
tAHcU
0A^_^
VWAVH
L$@H3
L$PH3
x AVH
VWAVH
 A^_^
VWAVH
TsFsD
 A^_^
x ATAVAWH
 A_A^A\
WAVAWH
TsFsH
0A_A^_
VWATAVAWH
0A_A^A\_^
t$ WATAUAVAWH
 A_A^A]A\_
x AVH
TsFsA
UVWATAUAVAWH
H!|$`I
tWA;.s;A
 A_A^A]A\_^]
p WAVAWH
A;6s;A
 A_A^_
VWATAVAWH
H!\$hL
D$XH!\$XH
H9D$ht
 A_A^A\_^
VWATAVAWH
H!\$`H
0A_A^A\_^
x ATAVAWH
 A_A^A\
x AVH
TsFsH
TsFsD
x ATAVAWH
TsFsH
|$0E3
D$@E3
A_A^A\
x AVH
USVWATAUAVAWH
}HD;uX
XA_A^A]A\_^[]
SUVWATAUAVAWH
8A_A^A]A\_^][
WAVAWH
 A_A^_
WATAUAVAWH
A_A^A]A\_
x AVH
D$ E3
x AVH
p AWH
t$ WH
D$ E3
L$0H3
p AWH
-fffffff
fffffff
fffffff
fffffff
.fffffff
fffffff
fffffff
fffff
AQAPRQPH
(D$ H
0XYZAXAY
ffffff
fffff
fffff
PsGetVersion
WmiTraceMessage
WmiQueryTraceInformation
EtwRegisterClassicProvider
EtwUnregister
StopWPPTracing
TSFairShare
EnableWPPTracing
pLoggerInfo == NULL failed: 0x%x in %s
RtlStringCchLength on TSFAIRSHARELOGGER failed: 0x%x in %s
pLoggerInfo->LoggerName.Buffer failed: 0x%x in %s
RtlStringCchCopy on TSFAIRSHARELOGGER failed: 0x%x in %s
%s\%s.etl
NtTraceControl failed: 0x%x in %s
?<5fp
TSFSLoadRegistrySettings
BreakOnStart
WPPTracing
CaptureStackTrace
LogDetailEvent
EnableFairShare
DetectionInSeconds
MaxWorkerThread
MaxIoCountSeconds
MaxReleaseIoTimeMS
MaxOutstandingIoTimeMS
DiskIoSamplingRateSecond
TraceLevel
WPPTracingToFile
RtlQueryRegistryValues failed: 0x%x in %s
TSFSPolicyChangeNotificationCallback
TSFSEndFiltering failed 0x%08x
ZwNotifyChangeKey failed: 0x%x in %s
TSFSShutdownPolicyChangeNotification
TSFSInitializePolicyChangeNotification
ZwOpenKey failed: 0x%x in %s
RtlQueryRegistryValuesEx
TSFSInitClassifierScheduler
Already initialized failed: 0x%x in %s
TSFSInitializeScheduler failed: 0x%x in %s
Scheduler return invalid function pointer failed: 0x%x in %s
TSFSInitializeClassify failed: 0x%x in %s
Classifier return invalid function pointer failed: 0x%x in %s
I_CompletePendedIo
FltLockUserBuffer failed with 0x%08x
I_AsyncCompletePendedWorkItemFunc
I_CompletePendedIo failed: 0x%x in %s
TSFSContinuePendedIo
FltAllocateDeferredIoWorkItem failed: 0x%x in %s
FltQueueDeferredIoWorkItem failed: 0x%x in %s
TSFSClassifierSchedulerShutdownDown
TSFSDestroyClassifierScheduler
TSClassifyDestroy failed with 0x%08x
TSSchedulerDestroy failed with 0x%08x
I_CheckBufferSize
I_QueryIoParameters
I_QueryIoTargetDevice
TSFSQueryIoInformation
NULL == pFltData failed: 0x%x in %s
STATUS_BUFFER_TOO_SMALL failed: 0x%x in %s
TSFSQueryIoInformation failed: 0x%x in %s
TSFSShouldSkipOperation
Not a local disk 0x%08x
TSFSInitializeGlobals
TSFSLoadRegistrySettings failed: 0x%x in %s
TSFSShouldPendIo
FltGetRequestorSessionId failed: 0x%x in %s
-1 == SessId failed: 0x%x in %s
NULL == QueryPendIoFn failed: 0x%x in %s
g_ClassifyQueryPendIoFn failed: 0x%x in %s
!g_Initialized failed: 0x%x in %s
TSFSProcessIoOperation
TSFS_ALLOCATE_POOL_WITH_TYPE PTSFSIOHANDLE failed: 0x%x in %s
NULL == ClassifyFn failed: 0x%x in %s
g_ClassifyFn failed: 0x%x in %s
\DosDevices\Global\TSFairShare
\Device\TSFairShare
DriverEntry
EventRegister failed with 0x%08x
termsrv\isolation\fairshare\mgr\driver.cpp
DriverEntry on %s
\REGISTRY\MACHINE\SYSTEM\CurrentControlSet\Services\TSFairShare
RtlStringCchLength on TSFS_DISK_FAIRSHARE failed: 0x%x in %s
TSFS_ALLOCATE_POOL failed: 0x%x in %s
%s\%s
TSFSLoadRegistrySettings failed 0x%08x
IoCreateDevice failed: 0x%x in %s
IoCreateSymbolicLink failed: 0x%x in %s
TSFSInitializeGlobals failed: 0x%x in %s
[1] TSFairshare started
TSFSStartFiltering failed: 0x%x in %s
TSFSUnload
DriverUnload
[2] TSFairshare Ended
TSFSPreReadWriteOperation
TSFSShouldPendIo failed with 0x%08x
TSFSProcessIoOperation failed with 0x%08x
TSFSPostReadWriteOperation
TSFSPreShutdownOperation
TSFSEndFiltering
[4] Disk fairshare ended
TSFSStartFiltering
TSFSInitClassifierScheduler failed: 0x%x in %s
FltRegisterFilter failed: 0x%x in %s
FltStartFiltering failed: 0x%x in %s
[3] Disk fairshare started
TSFSDeviceControl
TSFSDispatch
!FATAL!:
%s:%s
ClassifyQueue
Set Session %d to %s
Queue
Direct
[5] Remote Desktop Services Disk Fair Share has detected excessive disk activity for session %d. The session is in restrain mode.
[6] Remote Desktop Services Disk Fair Share detected that disk activity for session %d is back to normal. The session is no longer in restrain mode.
CTSClassifyQueue::NotifyIoSubmitted
CTSClassifyMgr::staticTSClassifyWorkerThread
TSClassifyWorkerThread failed: 0x%x in %s
CTSClassifyMgr::staticNotifyUnPendedIOCompletion
NotifyIoCompleted failed: 0x%x in %s
PutQueueInPendingModeifOverLimit failed: 0x%x in %s
CTSClassifyMgr::staticNotifyPendedIOCompletion
CTSClassifyQueue::GetInstanceOfObject
new CTSClassifyQueue failed: 0x%x in %s
CTSClassifyQueue::NotifyIoCompleted
SaveCurrentStats.m_TotalDuration < Tmp  failed: 0x%x in %s
 Tmp < SaveCurrentStats.m_ReadCompleteCoun failed: 0x%x in %s
Tmp < SaveCurrentStats.m_TotalReadBytes failed: 0x%x in %s
Tmp < SaveCurrentStats.m_WriteCompleteCount failed: 0x%x in %s
Tmp < SaveCurrentStats.m_TotalWriteBytes failed: 0x%x in %s
CTSClassifyQueue::StartMonitoringIfNeeded
CTSClassifyQueue::PutQueueInPendingModeifOverLimit
ITSClassifyMgr::GetInstanceOfObject
ITSClassifyMgr::GetInstanceOfObject failed: 0x%x in %s
CTSClassifyMgr
CTSClassifyMgr::CTSClassifyMgr
TSFS_ALLOCATE_POOL_WITH_TYPE for SPINLOCK failed: 0x%x in %s
TSFS_ALLOCATE_POOL KEVENT failed: 0x%x in %s
CTSClassifyMgr::~CTSClassifyMgr
CTSClassifyMgr::RegisterSessionNotification
IoRegisterContainerNotification failed: 0x%x in %s
CTSClassifyMgr::Cleanup
DestroyQueue failed with 0x%08x
CTSClassifyMgr::FindAndCreateQueue
TSFS_ALLOCATE_POOL_WITH_TYPE for bucket failed: 0x%x in %s
m_CreateBucketFn failed: 0x%x in %s
CTSClassifyQueue::GetInstanceOfObject failed: 0x%x in %s
this->m_QueueList.AddAt failed: 0x%x in %s
CTSClassifyMgr::TSClassifyWorkerThread
QueueInPendCount %d
CTSClassifyMgr::Initialize
RegisterSessionNotification failed: 0x%x in %s
PsCreateSystemThread failed: 0x%x in %s
ObReferenceObjectByHandle failed: 0x%x in %s
CTSClassifyMgr::ClassifyIoItem
%s failed 0x%x: FindAndCreateBucket failed for session ID 0x%08x
ptrQueue->GetQueue failed: 0x%x in %s
%s failed 0x%x: m_AddToBucketFn for process 0x%08x, session 0x%08x
ReleaseBucketHandle failed 0x%08x
CTSClassifyMgr::DestroyQueue
GetID failed: 0x%x in %s
m_DestroyBucketFn %p failed: 0x%x in %s
CTSClassifyMgr::FindAndDestroyQueue
%s failed 0x%x: DestroyQueue failed on %d
CTSClassifyMgr::staticSessionNotification
NULL == ptrClassifyMgr  failed: 0x%x in %s
IoGetContainerInformation failed: 0x%x in %s
%s failed 0x%x: FindAndDestroyQueue on Session %d
CTSClassifyMgr::WillPendIo
TSClassifyInitialize
NULL != g_pClassifyMgr failed: 0x%x in %s
g_pClassifyMgr->Initialize() failed: 0x%x in %s
TSClassifyDestroy
TSClassifyWillPendIo
NULL == ptrMgr failed: 0x%x in %s
%s failed 0x%x: WillPendIo failed SESSID 0x%08d, PID 0x%08x
TSClassifyNotifyIoStatisticChange
NotifyIoStatisticChange failed: 0x%x in %s
TSClassifyIoItem
%s failed 0x%x: ClassifyIoItem failed SESSID 0x%08d, PID 0x%08x
BUCKETITEM
CTSFSBucket::Initialize
m_QueueHead.Initialize failed: 0x%x in %s
CTSSchedulerMgr::UpdateDiskQuotaAndReleaseIo
CTSSchedulerMgr::staticTSSchedulerWorkerThread
TSSchedulerWorkerThread failed: 0x%x in %s
CTSSchedulerMgr::staticTSSchedulerWatchDogThread
TSSchedulerWatchDogThread failed: 0x%x in %s
CTSSchedulerMgr::FindBucketById
NULL == pTSFSBucket failed: 0x%x in %s
!bSuccess || NULL == ptrBucket failed: 0x%x in %s
BucketId != pQueueHande->Reserved2 failed: 0x%x in %s
CTSFSBucket::GetInstanceOfObject
new CTSFSBucket failed: 0x%x in %s
CTSFSBucket
CTSFSBucket::CTSFSBucket
Initialize failed: 0x%x in %s
CTSFSBucket::~CTSFSBucket
CTSFSBucket::Cleanup
CTSFSBucket::AddToQueue
new IOQUEUEITEM failed: 0x%x in %s
m_QueueHead.InsertTailList failed: 0x%x in %s
CTSFSBucket::GetItemWithOlderQueuedTime
CTSFSBucket::GetNextBucketItem
CTSSchedulerMgr::NotifyIoCompleted
UpdateDiskQuotaAndReleaseIo failed with 0x%08x
NULL == pBucket failed: 0x%x in %s
CTSFSBucket::NotifyIoCompleted
NULL == pBucketItem failed: 0x%x in %s
CTSFSBucket::IoSubmitError
ITSSchedulerMgr::GetInstanceOfObject
new CTSSchedulerMgr failed: 0x%x in %s
CTSSchedulerMgr
CTSSchedulerMgr::CTSSchedulerMgr
TSFS_ALLOCATE_POOL_WITH_TYPE on spinlock failed: 0x%x in %s
CTSSchedulerMgr::~CTSSchedulerMgr
this->Cleanup failed with 0x%08x
CTSSchedulerMgr::ContinueProcessIo
NULL == pContext failed: 0x%x in %s
m_pTSFSContinueIoFn failed: 0x%x in %s
CTSSchedulerMgr::FlushBucket
Failed to continue IO item 0x%08x
CTSSchedulerMgr::Cleanup
FlushBucket failed 0x%08x
CTSSchedulerMgr::DestroyQueue
pTSFSBucket->cbSize != sizeof(TSFSBUCKET) failed: 0x%x in %s
FindBucketById failed: 0x%x in %s
m_AvailableMap.ReleaseId failed 0x%08x
FlushQueue failed: 0x%x in %s
CTSSchedulerMgr::AddToQueue
pBucket->cbSize != sizeof(TSFSBUCKET) failed: 0x%x in %s
%s failed 0x%x: FindBucketById failed on 0x%08x
%s failed 0x%x: AddToQueue %d
CTSSchedulerMgr::CreateQueue
BufSize < sizeof(TSFSBUCKET) failed: 0x%x in %s
CTSFSBucket::GetInstanceOfObject failed: 0x%x in %s
this->m_AvailableMap.AcquireId failed: 0x%x in %s
bSuccess || NULL != ptrTmpBucket failed: 0x%x in %s
this->m_BucketArray.AddAt failed: 0x%x in %s
CTSSchedulerMgr::Initialize
TSFS_ALLOCATE_POOL KSEMAPHORE failed: 0x%x in %s
NULL == this->m_phWorkerThreads failed: 0x%x in %s
NULL == this->m_pThreadObjects failed: 0x%x in %s
NULL == this->m_pWaitBlockArray failed: 0x%x in %s
CTSSchedulerMgr::ReleaseLongWaitItem
ContinueProcessIo failed with 0x%08x
CTSSchedulerMgr::ProcessNextWorkItem
ContinueProcessIo failed: 0x%x in %s
NULL == pNextIoHandle failed: 0x%x in %s
CTSSchedulerMgr::WaitForShutdownOrObject
CTSSchedulerMgr::TSSchedulerWorkerThread
ProcessNextWorkItem
CTSSchedulerMgr::TSSchedulerWatchDogThread
ReleaseLongWaitItem failed with 0x%08x
CTSSchedulerMgr::Destroy
ShutdownWorkerThread failed 0x%08x
Cleanup failed 0x%08x
CTSSchedulerMgr::ShutdownWorkerThread
KeWaitForMultipleObjects failed with 0x%08x
KeWaitForSingleObjet failed with 0x%08x
TSSchedulerInitialize
NULL != g_ptrSchedulerMgr failed: 0x%x in %s
g_ptrSchedulerMgr->Initialize() failed: 0x%x in %s
TSSchedulerDestroy
TSSchedulerCreateBucket
NULL g_ptrSchedulerMgr failed: 0x%x in %s
TSSchedulerCreateBucket: *pBufSize < sizeof(TSFSBUCKET)
CreateQueue failed: 0x%x in %s
TSSchedulerDestroyBucket
DestroyQueue failed: 0x%x in %s
TSSchedulerAddToBucket
AddToQueue failed: 0x%x in %s
TSSchedulerNotifyIoStatisticChange
RDSNetFSSysClientDetachProvider
RDSNetFSSysClientAttachProvider
NmrClientAttachProvider failed: 0x%x in %s
RDSNetFSSysClientAttachProvider returns 0x%x
RDSNetFSSysDisableNetworkFairshare
NmrWaitForClientDeregisterComplete failed: 0x%x in %s
NmrDeregisterClient failed: 0x%x in %s
RDSNetFSSysDisableNetworkFairshare returns 0x%x
RDSNetFSSysEnableNetworkFairshare
TSFS_ALLOCATE_POOL_WITH_TYPE failed: 0x%x in %s
RDSNetFS
KeWaitForSingleObject failed: 0x%x in %s
RDSNetFSSysEnableNetworkFairshare returns 0x%x
RDSNetFSSysCreatePolicy
STATUS_INVALID_PARAMETER failed: 0x%x in %s
RDSNetFSSysIsEnabled failed: 0x%x in %s
RDSNetFSSysCreatePolicy returns 0x%x
RDSNetFSSysDeletePolicy
RDSNetFSSysDeletePolicy returns 0x%x
RDSNetFSSysDeleteAllPolicies
RDSNetFSSysDeleteAllPolicies returns 0x%x
RDSNetFSSysUpdatePolicy
RDSNetFSSysUpdatePolicy returns 0x%x
CheckCurrentProcessForServiceSid
RtlCheckTokenMembership failed: 0x%x in %s
IsCallerTermsrvService
RDSNetFSSysDispatchIoControl
IsCallerTermsrvService failed: 0x%x in %s
STATUS_ACCESS_DENIED failed: 0x%x in %s
RDSNetFSSysIsSystemProcess
system SID allocation failed: 0x%x in %s
RtlInitializeSid failed: 0x%x in %s
RSDSbF
TSFairShare.pdb
.text$mn
.text$mn$00
.text$mn$21
.rdata$brc
.giats
.rdata
.rdata$zzzdbg
.xdata
.data$brc
.data
.pdata
.idata$5
.00cfg
.idata$2
.idata$3
.idata$4
.idata$6
fogrp
.gfids
.rsrc$01
.rsrc$02
RtlInitUnicodeString
MmGetSystemRoutineAddress
IoWMIRegistrationControl
_vsnwprintf
RtlGetNtSystemRoot
NtTraceControl
RtlQueryRegistryValues
ZwNotifyChangeKey
ZwClose
ZwOpenKey
IoGetTopLevelIrp
PsInitialSystemProcess
KeAcquireSpinLockAtDpcLevel
KeAcquireSpinLockRaiseToDpc
KeEnterCriticalRegion
KeGetCurrentIrql
KeReleaseSpinLockFromDpcLevel
KeLeaveCriticalRegion
KeReleaseSpinLock
KeInitializeSpinLock
EtwRegister
IoCreateDevice
IoCreateSymbolicLink
EtwWriteTransfer
IoDeleteSymbolicLink
IoDeleteDevice
EtwUnregister
ObfDereferenceObject
IofCompleteRequest
ntoskrnl.exe
FltLockUserBuffer
FltCompletePendedPreOperation
FltFreeDeferredIoWorkItem
FltAllocateDeferredIoWorkItem
FltQueueDeferredIoWorkItem
FltGetIoPriorityHint
FltGetRequestorProcess
FltGetRequestorSessionId
FltGetDiskDeviceObject
FltGetRequestorProcessId
FltUnregisterFilter
FltRegisterFilter
FltStartFiltering
FLTMGR.SYS
NmrDeregisterClient
NmrClientDetachProviderComplete
NmrClientAttachProvider
NmrWaitForClientDeregisterComplete
NmrRegisterClient
NETIO.SYS
ExFreePool
ExAllocatePoolWithTag
KdDebuggerEnabled
_vsnprintf
KeWaitForMultipleObjects
PsCreateSystemThread
RtlCaptureStackBackTrace
IoGetContainerInformation
_purecall
IoRegisterContainerNotification
KeSetEvent
ObReferenceObjectByHandle
IoUnregisterContainerNotification
KeInitializeEvent
KeWaitForSingleObject
RtlInitializeBitMap
RtlFindClearBitsAndSet
RtlAreBitsSet
RtlClearBits
KeReadStateEvent
KeClearEvent
KeReleaseSemaphore
KeInitializeSemaphore
KeQueryActiveProcessorCountEx
ExInterlockedRemoveHeadList
ExInterlockedInsertTailList
RtlInitializeSid
RtlSubAuthoritySid
RtlCheckTokenMembership
RtlLengthRequiredSid
WATAUAVAWH
\$0E3
A_A^A]A\_
D$@fD
t$ WATAUAVAWH
A_A^A]A\_
t$ UWATAVAWH
A_A^A\_]
MC9K,tF
UAVAWH
A_A^]
UVWATAUAVAWH
H!_8L
@A_A^A]A\_^]
s WAVAWH
TsFsD
TsFsH
TsFsH
 A_A^_
t$ WAVAWH
D$8E3
D$`E3
@A_A^_
D$`E3
D$ E3
x AVH
L$(H3
x ATAVAWH
D$(f4
@A_A^A\
WATAUAVAWH
fD9 t
fD9 t
TsFsI
A_A^A]A\_
WEVT_TEMPLATE
VS_VERSION_INFO
StringFileInfo
040904B0
CompanyName
Microsoft Corporation
FileDescription
TSFairShare Filter Driver
FileVersion
10.0.22621.436 (WinBuild.160101.0800)
InternalName
TSFairShare.sys
LegalCopyright
 Microsoft Corporation. All rights reserved.
OriginalFilename
TSFairShare.sys
ProductName
Microsoft
 Windows
 Operating System
ProductVersion
10.0.22621.436
VarFileInfo
Translation
Remote Desktop Services Fair Share started.
Remote Desktop Services Fair Share stopped.
Remote Desktop Services Disk Fair Share started.
Remote Desktop Services Disk Fair Share stopped.
Remote Desktop Services Disk Fair Share has detected excessive disk activity for session %1. The session is in restrain mode.
Remote Desktop Services Disk Fair Share detected that disk activity for session %1 is back to normal. The session is no longer in restrain mode.
Error
Warning
Information
Verbose
Microsoft-Windows-TerminalServices-TSFairShare
System
Admin
Analytic
Operational
Debug
CHAN@
System
Microsoft-Windows-TerminalServices-TSFairShare/Admin
Microsoft-Windows-TerminalServices-TSFairShare/Analytic
Microsoft-Windows-TerminalServices-TSFairShare/Operational
Microsoft-Windows-TerminalServices-TSFairShare/Debug
EventXML
xmlns
Event_NS
message
message
NO)R%
EventXML
xmlns
Event_NS
Param1
Param1
TEMPP
EventData
Microsoft-Windows-TerminalServices-TSFairShare-Events
win:Error
win:Warning
win:Informational
win:Verbose
TS FairShare Filter Driver
\(]?]Z]q]
^!_7_{_
R:RURrR
TTU3VTV
\C]i]M_
VEWkW$X
S?T3U
T(TCT
TZUuU
]'_R_n_
PtQFRfR
U6VKV
UhUpV
XIX,^
Z#[5[
