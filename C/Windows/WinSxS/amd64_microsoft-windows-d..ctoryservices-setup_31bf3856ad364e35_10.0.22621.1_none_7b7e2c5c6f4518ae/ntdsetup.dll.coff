Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-d..ctoryservices-setup_31bf3856ad364e35_10.0.22621.1_none_7b7e2c5c6f4518ae\ntdsetup.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdsbsrv.dll
    WLDAP32.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    DSPARSE.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    RPCRT4.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-service-management-l2-1-0.dll
    CRYPT32.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-eventing-classicprovider-l1-1-0.dll
    WS2_32.dll
    logoncli.dll
    DNSAPI.dll
    api-ms-win-core-file-l2-1-2.dll
    netutils.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    bcrypt.dll
    api-ms-win-core-heap-l1-1-0.dll
    certcli.dll
    LSASRV.dll
    ADVAPI32.dll
    cryptdll.dll
    KERNEL32.dll
    ntdll.dll
    NTDSA.dll
    NTDSAPI.dll
    SAMSRV.dll
    SHLWAPI.dll

  Section contains the following exports for NTDSETUP.dll

    00000000 characteristics
    5BCE92DE time date stamp
        0.00 version
           1 ordinal base
          24 number of functions
          24 number of names

    ordinal hint RVA      name

          1    0 000185D0 AdamFetchDemotionInfo
          2    1 0000EDF0 AdamGetCrossRefs
          3    2 00018A10 FreeDemotionInfo
          4    3 00010240 NtdsAdamValidateInst
          5    4 000106D0 NtdsAdamValidateServiceAccount
          6    5 00010710 NtdsAdamVerifyBind
          7    6 000193D0 NtdsCheckMachineAccountFlags
          8    7 00019400 NtdsDemote
          9    8 000125C0 NtdsFreeDnsRRInfo
         10    9 000195B0 NtdsGetDefaultDnsName
         11    A 00004590 NtdsInstall
         12    B 000195C0 NtdsInstallCancel
         13    C 00019640 NtdsInstallReplicateFull
         14    D 00009990 NtdsInstallShutdown
         15    E 00019850 NtdsInstallUndo
         16    F 00019890 NtdsPrepareForDemotion
         17   10 000199B0 NtdsPrepareForDemotionUndo
         18   11 000199D0 NtdsPrepareForDsUpgrade
         19   12 00019C40 NtdsSetReplicaMachineAccount
         20   13 00002CB0 NtdspConfigRegistry
         21   14 000099F0 NtdspDNStoRFC1779Name
         22   15 0001BC70 NtdspFindSite
         23   16 00002790 NtdspValidateInstallParameters
         24   17 00002A90 NtdspVerifyDsEnvironment

  Section contains the following imports:

    msvcrt.dll
             180028AA0 Import Address Table
             18002FB20 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         370 _vsnprintf
                          5E __C_specific_handler
                         52D wprintf
                         47E iswcntrl
                         4E6 strtoul
                         488 isxdigit
                         42F bsearch
                         473 isdigit
                         188 _i64tow_s
                         518 wcsncmp
                         347 _ultow_s
                         1ED _local_unwind
                         49E memcmp
                         49F memcpy
                         4A1 memmove
                         4A3 memset
                         4E9 swprintf_s
                         523 wcstok
                         189 _initterm
                          B7 _amsg_exit
                          5A _XcptFilter
                         47D iswascii
                         4F6 tolower
                         416 _wtol
                         1FE _ltow
                         412 _wtoi
                         298 _msize
                         392 _wcsdup
                         4DF strrchr
                         4B1 qsort
                         3A1 _wcsnicmp
                         521 wcsstr
                         1E5 _itow
                         50E wcschr
                         528 wcstoul
                         512 wcscpy_s
                         1E6 _itow_s
                         525 wcstol
                         493 malloc
                         42D atoi
                         459 free
                         397 _wcsicmp
                         376 _vsnwprintf
                         50F wcscmp

    ntdsbsrv.dll
             180028D18 Import Address Table
             18002FD98 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 NtdsbsrvDllInit
                           4 UnInstallBackupServices

    WLDAP32.dll
             1800284C8 Import Address Table
             18002F548 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    12
                             Ordinal   155
                             Ordinal   170
                             Ordinal    46
                             Ordinal   145
                             Ordinal   142
                             Ordinal    36
                             Ordinal    14
                             Ordinal    73
                             Ordinal   127
                             Ordinal    97
                             Ordinal    41
                             Ordinal   135
                             Ordinal   167
                             Ordinal   140
                             Ordinal   147
                             Ordinal    16
                             Ordinal    88
                             Ordinal    27
                             Ordinal    26
                             Ordinal    18
                             Ordinal   203
                             Ordinal   206
                             Ordinal    13
                             Ordinal   133
                             Ordinal   161
                             Ordinal    79
                             Ordinal   113
                             Ordinal    21
                             Ordinal   224
                             Ordinal    69
                             Ordinal   208
                             Ordinal   301
                             Ordinal   157

    api-ms-win-core-heap-l2-1-0.dll
             180028698 Import Address Table
             18002F718 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 LocalAlloc
                           3 LocalFree
                           5 LocalReAlloc

    api-ms-win-core-errorhandling-l1-1-0.dll
             1800285F0 Import Address Table
             18002F670 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F SetUnhandledExceptionFilter
                           5 GetLastError
                          11 UnhandledExceptionFilter

    api-ms-win-security-base-l1-1-0.dll
             1800288D0 Import Address Table
             18002F950 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2C EqualSid
                          2E FreeSid
                          47 InitializeAcl
                          2D FindFirstFreeAce
                          4D IsValidSid
                          37 GetSecurityDescriptorControl
                          30 GetAclInformation
                          4F MakeAbsoluteSD
                          16 AllocateAndInitializeSid
                          2F GetAce
                          39 GetSecurityDescriptorGroup
                          63 SetSecurityDescriptorGroup
                          3A GetSecurityDescriptorLength
                          61 SetSecurityDescriptorControl
                          66 SetSecurityDescriptorSacl
                           8 AddAccessAllowedAceEx
                          28 DuplicateToken
                          3D GetSecurityDescriptorSacl
                          3B GetSecurityDescriptorOwner
                          48 InitializeSecurityDescriptor
                          62 SetSecurityDescriptorDacl
                          50 MakeSelfRelativeSD
                          59 RevertToSelf
                          38 GetSecurityDescriptorDacl
                          45 ImpersonateLoggedOnUser
                           D AddAce
                          35 GetLengthSid
                          64 SetSecurityDescriptorOwner

    api-ms-win-core-registry-l1-1-0.dll
             180028760 Import Address Table
             18002F7E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 RegDeleteTreeW
                          2E RegSetValueExW
                          1D RegOpenKeyExA
                           0 RegCloseKey
                           B RegDeleteValueW
                           2 RegCreateKeyExA
                          2D RegSetValueExA
                          25 RegQueryValueExW
                          1E RegOpenKeyExW
                          1B RegNotifyChangeKeyValue
                          24 RegQueryValueExA

    DSPARSE.dll
             180028258 Import Address Table
             18002F2D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F DsMakeSpnW

    api-ms-win-core-processthreads-l1-1-0.dll
             180028720 Import Address Table
             18002F7A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           C GetCurrentProcess
                           8 ExitProcess
                           D GetCurrentProcessId
                          11 GetCurrentThreadId
                          55 TerminateProcess

    api-ms-win-service-management-l1-1-0.dll
             1800289C8 Import Address Table
             18002FA48 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 OpenServiceW
                           0 CloseServiceHandle
                           2 CreateServiceW
                           3 DeleteService
                           4 OpenSCManagerW

    api-ms-win-core-libraryloader-l1-2-0.dll
             1800286B8 Import Address Table
             18002F738 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 DisableThreadLibraryCalls
                           D FreeLibrary
                          16 GetProcAddress
                          19 LoadLibraryExW
                          18 LoadLibraryExA
                          12 GetModuleHandleA

    api-ms-win-core-localization-l1-2-0.dll
             1800286F0 Import Address Table
             18002F770 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 FormatMessageW
                          24 GetUserDefaultLangID

    api-ms-win-security-sddl-l1-1-0.dll
             1800289B8 Import Address Table
             18002FA38 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ConvertSidToStringSidW

    RPCRT4.dll
             180028450 Import Address Table
             18002F4D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         215 RpcStringFreeW
                         21E UuidCreate
                         227 UuidToStringW

    api-ms-win-core-processenvironment-l1-1-0.dll
             180028708 Import Address Table
             18002F788 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B GetEnvironmentVariableW
                           0 ExpandEnvironmentStringsA

    api-ms-win-core-file-l1-1-0.dll
             180028610 Import Address Table
             18002F690 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D FindClose
                          55 SetFileAttributesW
                           A DeleteFileW
                          2D GetFileAttributesW
                          15 FindFirstFileW
                          50 RemoveDirectoryW
                           4 CreateDirectoryW
                          1B FindNextFileW

    api-ms-win-core-string-l1-1-0.dll
             1800287E0 Import Address Table
             18002F860 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CompareStringW
                           6 MultiByteToWideChar
                           0 CompareStringEx

    api-ms-win-core-handle-l1-1-0.dll
             180028668 Import Address Table
             18002F6E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-service-management-l2-1-0.dll
             1800289F8 Import Address Table
             18002FA78 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 ChangeServiceConfig2W

    CRYPT32.dll
             180028220 Import Address Table
             18002F2A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          C4 CryptProtectMemory
                          E2 CryptUnprotectMemory
                          E1 CryptUnprotectData
                          C3 CryptProtectData

    api-ms-win-core-sysinfo-l1-1-0.dll
             180028868 Import Address Table
             18002F8E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 GetComputerNameExW
                          16 GetSystemTimeAsFileTime
                           F GetSystemDirectoryW
                          1A GetTickCount
                          20 GetWindowsDirectoryW
                          13 GetSystemTime

    api-ms-win-service-winsvc-l1-1-0.dll
             180028A08 Import Address Table
             18002FA88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ControlService
                           A QueryServiceStatus

    api-ms-win-core-synch-l1-2-0.dll
             180028858 Import Address Table
             18002F8D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D Sleep

    api-ms-win-eventing-classicprovider-l1-1-0.dll
             1800288A0 Import Address Table
             18002F920 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 GetTraceEnableLevel
                           3 RegisterTraceGuidsW
                           0 GetTraceEnableFlags
                           2 GetTraceLoggerHandle
                           6 TraceMessageVa

    WS2_32.dll
             1800285E0 Import Address Table
             18002F660 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    14

    logoncli.dll
             180028A90 Import Address Table
             18002FB10 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 DsGetDcNameW

    DNSAPI.dll
             180028248 Import Address Table
             18002F2C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          CF DnsValidateName_W

    api-ms-win-core-file-l2-1-2.dll
             180028658 Import Address Table
             18002F6D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CopyFileW

    netutils.dll
             180028C08 Import Address Table
             18002FC88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 NetApiBufferFree

    api-ms-win-core-synch-l1-1-0.dll
             180028800 Import Address Table
             18002F880 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          18 InitializeCriticalSection
                           3 CreateEventA
                           1 AcquireSRWLockShared
                          25 ReleaseSRWLockShared
                           0 AcquireSRWLockExclusive
                          11 EnterCriticalSection
                          24 ReleaseSRWLockExclusive
                           F DeleteCriticalSection
                          1D LeaveCriticalSection
                          1B InitializeSRWLock

    api-ms-win-core-rtlsupport-l1-1-0.dll
             1800287C0 Import Address Table
             18002F840 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B RtlLookupFunctionEntry
                           2 RtlCaptureContext
                          11 RtlVirtualUnwind

    api-ms-win-core-profile-l1-1-0.dll
             180028750 Import Address Table
             18002F7D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    bcrypt.dll
             180028A20 Import Address Table
             18002FAA0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 BCryptHashData
                           D BCryptDestroyHash
                           2 BCryptCloseAlgorithmProvider
                          1D BCryptGenRandom
                          27 BCryptOpenAlgorithmProvider
                          21 BCryptGetProperty
                          1B BCryptFinishHash
                           6 BCryptCreateHash

    api-ms-win-core-heap-l1-1-0.dll
             180028678 Import Address Table
             18002F6F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 HeapAlloc
                           6 HeapFree
                           0 GetProcessHeap

    certcli.dll
             180028A68 Import Address Table
             18002FAE8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1B CADeleteLocalAutoEnrollmentObject
                          14 CACreateLocalAutoEnrollmentObject

    LSASRV.dll
             180028288 Import Address Table
             18002F308 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          3C LsaIFree_LSAPR_POLICY_INFORMATION
                          78 LsaIQueryInformationPolicyTrusted
                         10F LsarSetInformationPolicy
                          85 LsaISafeMode
                         103 LsarClose
                          75 LsaIOpenPolicyTrusted

    ADVAPI32.dll
             180028160 Import Address Table
             18002F1E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         2B6 ReportEventW
                         1C4 LsaLookupSids
                         1BF LsaLookupNames
                         2A4 RegisterEventSourceW
                          ED DeregisterEventSource
                         1C7 LsaNtStatusToWinError
                         1B1 LsaFreeMemory
                          7D ConvertStringSDToSDDomainW
                         25D RegCreateKeyW
                         1D4 LsaQueryInformationPolicy
                         1C9 LsaOpenPolicy
                         1A0 LsaClose
                         285 RegOpenKeyW
                         1E0 LsaSetInformationPolicy
                         258 RegCreateKeyA
                          61 ClearEventLogW
                         265 RegDeleteKeyW
                         2CE SetEntriesInAclW
                          64 CloseEventLog
                         2D9 SetNamedSecurityInfoW
                         142 GetNamedSecurityInfoW
                         190 LogonUserW
                         20A OpenEventLogW

    cryptdll.dll
             180028A80 Import Address Table
             18002FB00 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 CDGenerateRandomBits

    KERNEL32.dll
             180028268 Import Address Table
             18002F2E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         40E MoveFileW
                         2CA GetPrivateProfileStringW
                         1F9 GetComputerNameW

    ntdll.dll
             180028C18 Import Address Table
             18002FC98 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         339 RtlConvertSidToUnicodeString
                         470 RtlIdentifierAuthoritySid
                         4EB RtlLargeIntegerToChar
                         3D0 RtlEqualSid
                         1C0 NtOpenThreadToken
                         101 NtClose
                         577 RtlReAllocateHeap
                         44A RtlGetNtProductType
                         25B NtSetInformationThread
                         1AD NtOpenKey
                         15D NtEnumerateKey
                         14D NtDeleteKey
                         4F1 RtlLengthSecurityDescriptor
                         1F3 NtQueryKey
                          3D EtwEventUnregister
                         6F8 WinSqmAddToStream
                         346 RtlCopySid
                         4F0 RtlLengthRequiredSid
                         5F6 RtlSubAuthorityCountSid
                         5F7 RtlSubAuthoritySid
                         49F RtlInitializeSid
                         648 RtlValidSid
                         51E RtlNtStatusToDosError
                         40D RtlFreeHeap
                         2E1 RtlAllocateAndInitializeSid
                         489 RtlInitUnicodeString
                         2E4 RtlAllocateHeap
                         4F2 RtlLengthSid
                          5B EvtIntReportEventAndSourceAsync
                          3B EtwEventRegister
                         709 WinSqmIsOptedIn

    NTDSA.dll
             1800282C0 Import Address Table
             18002F340 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          43 DsIsDCReadOnly
                          82 THClearErrors
                          59 GetConfigurationName
                          6E NameMatched
                          4F DsaDisableUpdates
                          17 DirErrorToWinError
                          87 THQuery
                          6F NameMatchedStringNameOnly
                          5A GetConfigurationNamesList
                           B DSInstanceFromSetupEx
                          83 THCreate
                          7F SampSetDsa
                          26 DirReplicaGetDemoteTarget
                          2C DirSearch
                          74 QuoteRDNValue
                          8D TrimDSNameBy
                          85 THFree
                          21 DirRead
                          4A DsUninitialize
                          50 DsaEnableUpdates
                          5F InitCommarg
                          40 DsInitialize
                           0 AppendRDN
                          84 THDestroy
                          4C DsUnloadDLL
                          81 THAlloc
                          5C GetRDNInfoExternal
                          45 DsLoadDLL
                          23 DirReplicaAdd
                          2B DirReplicaSynchronize
                           A DSInstanceFromNameEx
                          25 DirReplicaDemote
                          51 DsaSetInstallCallback
                          1B DirModifyEntry
                          13 DirAddEntry
                          2A DirReplicaSetCredentials
                           3 CountNameParts
                          86 THGetErrorString

    NTDSAPI.dll
             1800283F8 Import Address Table
             18002F478 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6C DsReplicaSyncW
                           D DsBindWithSpnExW
                          5B DsRemoveDsDomainW
                          39 DsInitDemotionW
                           A DsBindWithCredW
                          74 DsUnBindW
                           5 DsBindByInstanceW
                          63 DsReplicaDemotionW
                          5D DsRemoveDsServerW
                          1E DsFinishDemotionW

    SAMSRV.dll
             180028470 Import Address Table
             18002F4F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          5F SamIUnLoadDownlevelDatabase
                          45 SamIPromoteUndo
                          4F SamIReplaceDownlevelDatabase
                         124 SampUsingDsData
                          44 SamIPromote
                          13 SamIDemote
                          14 SamIDemoteUndo
                          39 SamILoadDownlevelDatabase

    SHLWAPI.dll
             1800284B8 Import Address Table
             18002F538 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6B PathIsRootW

  Summary

        2000 .data
        2000 .pdata
        A000 .rdata
        1000 .reloc
        1000 .rsrc
       27000 .text
