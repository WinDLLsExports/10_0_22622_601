!This program cannot be run in DOS mode.
.text
`.rdata
@.data
.pdata
@.rsrc
@.reloc
@USVWATAUAVAWH
A_A^A]A\_^[]
VWAVH
 A^_^
@SUVWATAVAWH
0A_A^A\_^][
UVWATAUAVAWH
p`QXP
H9P s
H;Q sUH
UUUUUUU
l$ E3
A_A^A]A\_^]
H;^Ht&H
t$ UWATH
L9@ s
t$ WH
VWAVH
pc\p=
0A^_^
D$0E3
VWAVH
0A^_^
qqX0#'
L9P s
u5L;Q r/H;
q;U^?
` UAVAWH
@A_A^]
D$ E3
pcPv.
UUUUUUU
WATAUAVAWH
fD9d]
0A_A^A]A\_
WAVAWH
 A_A^_
x ATAVAWH
 A_A^A\
x AVH
H SUVWAVH
0A^_^][
x ATAVAWH
D$0I9<$
UUUUUUU
A_A^A\
@SVWATAUAVAWH
|$HM;
|$HL;
PA_A^A]A\_^[
WAVAWH
 A_A^_
x AVH
t$PL9wxtCM
|$ H;|$(t;H
H;|$(u
AUAVAWH
t$0L;>t5H
@A_A^A]
VWAVH
|$(H;7t1H
0A^_^
AUAVAWH
t$0L;6t5H
@A_A^A]
Y(u`H
VWAVH
 A^_^
WATAUAVAWH
H9Q(u
0A_A^A]A\_
t$ WH
T$8H;
VWAVH
 A^_^
WATAUAVAWH
l$HI!u
p!PZa
`A_A^A]A\_
t$ UWAVH
uPf9C
p0\:#7
WAVAWH
9A98uCA9x
pcPZt
0A_A^_
VWAVH
 A^_^
|$0H;
l$ VWATAVAWH
H9_htCH
OpH91t
A_A^A\_^
|$ UATAUAVAWH
OxL91t
I94$t
A_A^A]A\]
t$ UWAVH
usH!t$PH
|$ UAVAWH
p;U^?
A_A^]
VWAVH
PA^_^
SVWAVH
(A^_^[
q*]XL6
q8\vy
x AVH
9\$pu
uxH9_xt9H
{ UAVAWH
E H9K@t3H
A_A^]
WAVAWH
0A_A^_
p AWH
UAVAWH
fE9xl
fD9{l
A_A^]
#D9{hH
L9{Pt
x AVH
t+I9^
L$ E3
t$ E3
L9t$P
t$`fD9t$`t8H
fD90u
D$`H+
t$ UWATAVAWH
D$ E3
D9|$`u
D$ E3
u,D9|$`u
A_A^A\_]
@SUVWAVH
D$0H+
D$ H+
A^_^][
SVWATAUAVAWH
f94Bu
fA9tE
PA_A^A]A\_^[
x AVH
D97|X9
UVWATAUAVAWH
A_A^A]A\_^]
@SVWATAUAVAW
A_A^A]A\_^[
fD9 u
L$0E3
8w2t*
D$ E3
WAVAWH
fD;9u
 A_A^_
fD;0t
@USVWATAUAVAWH
\$ E3
?=u$L
?{uOH
|$ E3
D$ E3
D$ E3
9T$`A
A_A^A]A\_^[]
\$ UVWATAUAVAW
/fD;e
A_A^A]A\_^]
f;D$@u
VWAVH
D$hH9D$`t
D$hH9D$`t
UVWAVAWH
DD`fE;
A_A^_^]
p AWH
UWATAUAVH
O0H91t
A^A]A\_]
@USWH
|$ UH
@SUVWAVH
T$@H;
A^_^][
t$ WAVAWH
wXH;w`t=H
pRZ4\
 A_A^_
WATAVH
0A^A\_
\$ UVWH
UVWATAUAVAWH
!\$(H!\$ A
A_A^A]A\_^]
L$`H3
\$ WH
SVATAVAWH
0A_A^A\^[
|$0H;
@8y(t
SVAVAWH
(A_A^^[
Y@u`H
@USWH
x UATAUAVAWH
A8<$t
H9~`tCH
A_A^A]A\]
t$ WAVAWH
\$PH9_`tCH
0A_A^_
x ATAVAWH
 A_A^A\
x ATAVAWH
 A_A^A\
VWATAVAWH
@A_A^A\_^
u$H!p
SVATAUAVAWH
CP!CT!CXH!C`H!ChH
8A_A^A]A\^[
SVWAVAWH
 A_A^_^[
VWAVH
 A^_^
x AVH
t$XA+
D$8E3
|$0H;
UWAVH
@USVWAVH
A^_^[]
UVWATAUAVAWH
L$PE3
D$0Mc
D$0fD
L9d$Hu<I
A_A^A]A\_^]
t$ WH
VWAVH
(D$0f
`A^_^
WAVAWH
(D$Pf
A_A^_
x UAVAWH
A_A^]
D$0E3
D$0E3
q:XrS
H;|$(u
VWAVH
pc\p=
0A^_^
SVWATAVAWH
8A_A^A\_^[
WAVAWH
 A_A^_
WAVAWH
@A_A^_
@SVWATAUAVAWH
0A_A^A]A\_^[
WAVAWH
 A_A^_
WAVAWH
 A_A^_
x AVH
fD94Bu
K`H91t
KhH99t
qc\p=
UWAVH
H9_Xt
qqQ24
;@8yQu
@USVWATAUAVAWH
D9t$0
D;t$0
L$8E3
A_A^A]A\_^[]
x AVH
UVWATAUAVAWH
`A_A^A]A\_^]
D9(v 
L$PH3
9>v#D
\$ UVWAVAWH
t fD9;t
A_A^_^]
UVWAVAWH
fD9|u
fD9<xu
A_A^_^]
|$ UH
p;U^?
t$ E3
SVWATAUAVAWH
 A_A^A]A\_^[
x AVH
OHH+wpH
UVWAVAWH
KHH99t
`A_A^_^]
pjRXr
9D$8u
pjRXr
9D$8uOH
WAVAWH
G8H!G@H!GHH
 A_A^_
@SVWATAUAVAWH
0A_A^A]A\_^[
ud9D$PtRH
t$ WH
H UATAUAVAWH
A_A^A]A\]
@USVWATAUAVAWH
xA_A^A]A\_^[]
p AWH
t$ WH
=9t$Pt5H
` AUAVAWH
D$@H+
A_A^A]
WATAUAVAWH
0A_A^A]A\_
@USVWH
h_^[]
9|$`t
L$ VWAVH
0A^_^
x AVH
s0H97t
t$8L;>t5H
|$0H;7t5H
|$8H;7t5H
t$ WH
UWAVH
 A^_]
VWAVH
0A^_^
VWAVH
0A^_^
` AUAVAWH
D$@9X }
;Y }_H
UUUUUUU
(L91t
u&;Y |!H;
A_A^A]
VWAVH
s;H;Q
 A^_^
\$ UVWAVAWH
 A_A^_^]
D$09H }
x ATAVAWH
 A_A^A\
WAVAWH
 A_A^_
u)A8q
WAVAWH
D9@ }
 A_A^_
WATAUAVAWH
(D$ f
0A_A^A]A\_
|$ AVH
H;{ H
UVWATAUAVAWH
M#}0M
H;\$xt0H;
H9l$pu
 A_A^A]A\_^]
H9l$pu
l$hL#
H;\$pt
|$ ATAVAWH
@A_A^A\
M H9E
pqQ24
UWATAVAWH
pqQ24
A_A^A\_]
SVAVH
 A^^[
q"U^#
@USWH
t$ WAVAWH
PH9)t
|$PH9;tAH
0A_A^_
H;_hu
WAVAWH
 A_A^_
VWAVH
\$ H9_8tCH
0A^_^
T$8E3
VWATAVAWH
VhI;Vpt$H
`A_A^A\_^
UVWAVAWH
PA_A^_^]
YHu`H
VWAVH
 A^_^
SVAVH
 A^^[
SVWATAUAVAWH
@A_A^A]A\_^[
9Huk3
9y@~63
{@t H
WAVAWH
@A_A^_
UVWATAUAVAWH
A9u0u[I
A_A^A]A\_^]
|$ UATAUAVAWH
A_A^A]A\]
VWAVH
H;{0u
 A^_^
UVWATAUAVAWH
A_A^A]A\_^]
H;C0r
x ATAVAWH
H;{0r
 A_A^A\
x AVH
@SVWATAUAVAWH
@A_A^A]A\_^[
@SVWATAUAVAWH
@A_A^A]A\_^[
WAVAWH
 A_A^_
L$ SVWAVH
A^_^[
x AVH
VAVAWH
~ L;~(r
0A_A^^
L;A s
t$ WATAUAVAWH
D$PH;
ulM;g 
D$PH;
 A_A^A]A\_
l$ VWAVH
L$@H3
@USVWATAUAVAWH
D$@E3
xA_A^A]A\_^[]
\$ WH
L$0t0
@SVWATAUAVAWH
T$0E3
Dt$0A
fD9$Qu
@A_A^A]A\_^[
WAVAWH
f9<Bu
f9<Fu
f9<nu
 A_A^_
@USVWAVH
L9t$ 
fD94Au
A^_^[]
x AVH
t$ UH
WAVAWH
D$ E3
`A_A^_
qsU8#&
D$ H;
UATAUAVAWH
H9s u
A_A^A]A\]
UATAUAVAWH
A_A^A]A\]
UWAVH
0A^_]
L$8H3
L$8H3
H SUVWAVAWH
8A_A^_^][
q0R^G'
q0R^G'
q:_0#
|$ AVH
VWAVH
p:_0#
p:_0#
p:_0#
@A^_^
q:_0#
SVWAVH
8A^_^[
WAVAWH
\$8H;
A_A^_
WAVAWH
0A_A^_
\$ WH
@SVWH
p:_0#
\$ UH
M H1E
 H3E H3E
ntelA
ineID
L$ SUVWH
8_^][
x AVH
bad allocation
ForceRemove
NoRemove
Delete
{1b7cd997-e5ff-4932-a7a6-2a9e636da385}
toolUI
edgehtml.dll
F12\F12Tab2.dll
F12\F12Tab.dll
DllGetClassObject
debug
JS_DEBUG_DSH
 #%lu
F12 Debugger Script Engine
dbgsh://%d/%s
A script error has occurred in the remote side JavaScript:
Message: %s
File: %s
Line: %u
remotescripterror
detach
closed
vector too long
bad array new length
Unknown exception
map/set too long
iertutil.dll
ATL:%p
@Qm6t
{DB78C36C-0C1D-4D30-B722-2D4C252523F1}
\Required Categories
CLSID\
\Implemented Categories
Module
Module_Raw
REGISTRY
HKEY_CLASSES_ROOT
HKEY_CURRENT_USER
HKEY_LOCAL_MACHINE
HKEY_USERS
HKEY_PERFORMANCE_DATA
HKEY_DYN_DATA
HKEY_CURRENT_CONFIG
AppID
CLSID
Component Categories
FileType
Interface
Hardware
SECURITY
SYSTEM
Software
TypeLib
API-MS-Win-Core-LocalRegistry-L1-1-0.dll
RegDeleteKeyExW
advapi32.dll
RegDeleteKeyW
APPID
RemoteDiagnostics.js
dsh://%d/%s
F12DSEDEBUGENABLED
Unknown remote file
breakFlags
portName
commandId
OnGetBreakFlagsResult
OnBreakpointHit
column
message
OnRemoteScriptError
TakeMemorySnapshot
GetHWND
GetBreakFlags
OnHWND
OnConnect
OnMessage
OnDetach
engineId
OpenAndReadFileFromModuleResources '%s' failed
UTF-8
attach
break
Cw48?
message
partId
objectId
sizeIsApproximate
<Type Name Not Found>
isNew
isRoot
isSiteClosed
external
winrt
properties
indices
relationships
events
prototype
functionName
scopes
elementAttributesSize
elementTextChildrenSize
internalProperties
value
numberValue
Infinity
-Infinity
stringValue
UNKNOWN relationshipinfo
UNKNOWN
isGetter
isSetter
length
unordered_map/set too long
invalid hash bucket count
connect
=L9o<
atlthunk.dll
AtlThunk_AllocateData
AtlThunk_InitData
AtlThunk_DataToCode
AtlThunk_FreeData
WM_F12_SITE_COMMAND
UTF-16LE
rt, ccs=
sfs+/v/+/v++/v9+/v8
Object
oJ3]1"
false
\u%04x
DiagnosticsTap.pdb
.text$di
.text$mn
.text$mn$00
.text$x
.text$yd
.rdata$brc
.idata$5
.00cfg
.CRT$XCA
.CRT$XCL
.CRT$XCU
.CRT$XCZ
.CRT$XIA
.CRT$XIC
.CRT$XIZ
.CRT$XPA
.CRT$XPZ
.CRT$XTA
.CRT$XTZ
.gehcont
.gfids
.giats
.rdata
.rdata$r
.rdata$voltmd
.rdata$zzzdbg
.rtc$IAA
.rtc$IZZ
.rtc$TAA
.rtc$TZZ
.xdata
.xdata$x
ATL$__a
ATL$__m
ATL$__z
.edata
.idata$2
.idata$3
.idata$4
.idata$6
.data$brc
.data$r$brc
.data$rs$brc
.data
.pdata
.rsrc$01
.rsrc$02
8!g A
XLVlrB>BtBv@
08@HPX`hpx
 >"\ 
DiagnosticsTap.dll
DllCanUnloadNow
DllGetClassObject
DllInstall
DllRegisterServer
DllUnregisterServer
?_Xlength_error@std@@YAXPEBD@Z
?_Xbad_function_call@std@@YAXXZ
msvcp_win.dll
_isnan
_finite
_initterm
_initterm_e
api-ms-win-crt-math-l1-1-0.dll
api-ms-win-crt-string-l1-1-0.dll
api-ms-win-crt-runtime-l1-1-0.dll
__CxxFrameHandler4
__std_terminate
__C_specific_handler
__std_type_info_compare
_o___std_exception_copy
_o___std_exception_destroy
_o___std_type_info_destroy_list
_o___stdio_common_vswprintf
_o___stdio_common_vswprintf_s
_o__callnewh
_o__cexit
_o__configure_narrow_argv
_o__crt_atexit
_o__errno
_o__execute_onexit_table
_o__fpclass
_o__i64tow_s
_o__initialize_narrow_environment
_o__initialize_onexit_table
_o__invalid_parameter_noinfo
_o__invalid_parameter_noinfo_noreturn
_o__itow_s
_o__purecall
_o__recalloc
_o__register_onexit_function
_o__seh_filter_dll
_o__ui64tow_s
_o__wfopen_s
_o_calloc
_o_ceilf
_o_fclose
_o_fgetws
_o_free
_o_malloc
_o_terminate
_o_wcscat_s
_o_wcscpy_s
_o_wcsncat_s
_o_wcsncpy_s
_o_wcstol
_o_wmemcpy_s
__current_exception
__current_exception_context
memset
_CxxThrowException
api-ms-win-crt-private-l1-1-0.dll
RegCloseKey
RegQueryInfoKeyW
RegEnumKeyExW
RegOpenKeyExW
RegSetValueExW
RegCreateKeyExW
RegDeleteValueW
GetSecurityDescriptorOwner
GetSecurityDescriptorGroup
GetSecurityDescriptorDacl
GetSecurityDescriptorSacl
GetSecurityDescriptorControl
ADVAPI32.dll
GetLastError
FindAtomW
GetModuleHandleW
LoadLibraryExW
GetProcAddress
GetUserDefaultLCID
OutputDebugStringW
GetEnvironmentVariableW
SizeofResource
LockResource
LoadResource
FindResourceExW
DeleteCriticalSection
InitializeCriticalSection
SetEvent
EnterCriticalSection
LeaveCriticalSection
GetModuleFileNameW
CloseHandle
FreeLibrary
GetCurrentThreadId
CreateEventW
CreateThread
WaitForSingleObject
RaiseException
SetLastError
lstrcmpiW
MultiByteToWideChar
GetThreadLocale
SetThreadLocale
CompareStringOrdinal
GetCurrentProcess
OpenProcess
CreatePipe
DuplicateHandle
GetCurrentProcessId
ReadFile
WriteFile
HeapSize
HeapReAlloc
HeapFree
HeapAlloc
GetProcessHeap
HeapDestroy
VirtualFree
VirtualAlloc
LoadLibraryExA
EncodePointer
DecodePointer
FlushInstructionCache
InterlockedPushEntrySList
InterlockedPopEntrySList
RtlCaptureContext
RtlLookupFunctionEntry
RtlVirtualUnwind
UnhandledExceptionFilter
SetUnhandledExceptionFilter
TerminateProcess
IsProcessorFeaturePresent
QueryPerformanceCounter
GetSystemTimeAsFileTime
InitializeSListHead
IsDebuggerPresent
KERNEL32.dll
OLEAUT32.dll
CreateUri
CoInternetCombineUrlEx
urlmon.dll
DefWindowProcW
IsWindow
PostMessageW
PostQuitMessage
SendMessageW
PostThreadMessageW
PeekMessageW
GetMessageW
TranslateMessage
DispatchMessageW
RegisterClassExW
GetClassInfoExW
LoadCursorW
CreateWindowExW
SetWindowLongPtrW
GetWindowLongPtrW
CallWindowProcW
CharNextW
UnregisterClassA
USER32.dll
CoCreateInstance
CoTaskMemFree
CoTaskMemRealloc
CoTaskMemAlloc
StringFromGUID2
api-ms-win-core-com-l1-1-0.dll
GetSidLengthRequired
InitializeSid
GetSidSubAuthority
CopySid
GetLengthSid
IsValidSid
InitializeAcl
AddAce
GetAclInformation
SetSecurityDescriptorDacl
MakeSelfRelativeSD
GetSecurityDescriptorLength
MakeAbsoluteSD
InitializeSecurityDescriptor
GetTokenInformation
OpenProcessToken
FindFirstFileW
FindClose
FindResourceW
GetModuleHandleExW
PathGetCharTypeW
SHLWAPI.dll
RegisterWindowMessageW
wcscmp
__C_specific_handler_noexcept
memcmp
memcpy
memmove
.?AV<lambda_d6f2795b617fb205e86479cc167fdcab>@@
.?AVbad_array_new_length@std@@
.?AVbad_alloc@std@@
.?AVexception@std@@
.?AVCAtlException@ATL@@
.?AV<lambda_cd19cd07b0047bef4142390703d6f37a>@@
.?AV<lambda_d6f2795b617fb205e86479cc167fdcab>@@
.?AV<lambda_af81075e3d946b11783ee464b9470349>@@
.?AV<lambda_d6f2795b617fb205e86479cc167fdcab>@@
.?AVlength_error@std@@
.?AV<lambda_d6f2795b617fb205e86479cc167fdcab>@@
.?AVtype_info@@
.?AVEventHelper@@
.?AV_Ref_count_base@std@@
.?AV?$_Ref_count@E@std@@
.?AVCSecurityDesc@ATL@@
.?AVCAccessAce@CDacl@ATL@@
.?AVCDacl@ATL@@
.?AVCAce@CAcl@ATL@@
.?AVCAcl@ATL@@
.?AVCSid@ATL@@
REGISTRY
TYPELIB
VS_VERSION_INFO
StringFileInfo
040904B0
CompanyName
Microsoft Corporation
FileDescription
F12 Developer Tools Diagnostics TAP
FileVersion
11.00.22621.1 (WinBuild.160101.0800)
InternalName
DiagnosticsTap.dll
LegalCopyright
 Microsoft Corporation. All rights reserved.
OriginalFilename
DiagnosticsTap.dll
ProductName
Internet Explorer
ProductVersion
11.00.22621.1
VarFileInfo
Translation
    NoRemove CLSID
    {
        ForceRemove {8C0C62FD-37F1-11E3-8259-6C3BE516EAD0} = s 'TapObject Class'
        {
            ForceRemove Programmable
            InprocServer32 = s '%MODULE%'
            {
                val ThreadingModel = s 'Apartment'
            }
            TypeLib = s '{8C0C62FB-37F1-11E3-8259-6C3BE516EAD0}'
            Version = s '1.0'
        }
    }
    NoRemove CLSID
    {
        ForceRemove {CA7C1262-EA3B-4508-B120-DF9BCDEF3E60} = s 'LocalDebuggeeScriptHostFactory2 Class'
        {
            ForceRemove Programmable
            InprocServer32 = s '%MODULE%'
            {
                val ThreadingModel = s 'Both'
            }
            TypeLib = s '{8C0C62FB-37F1-11E3-8259-6C3BE516EAD0}'
            Version = s '1.0'
        }
    }
    NoRemove CLSID
    {
        ForceRemove {8C0C6304-37F1-11E3-8259-6C3BE516EAD0} = s 'MessageDispatch Class'
        {
            ForceRemove Programmable
            InprocServer32 = s '%MODULE%'
            {
                val ThreadingModel = s 'Both'
            }
            TypeLib = s '{8C0C62FB-37F1-11E3-8259-6C3BE516EAD0}'
            Version = s '1.0'
        }
    }
stdole2.tlbWWW
"DiagnosticsTapLibWWW
TapObjectWWWd
ITapObjectWW
ULONG_PTRWWWd
NInitializeWW
readHandleWW
writeHandleWd
GetBreakFlagsWWW
XpFlagsOutWWW,
tIDiagnosticsScriptEngineSite,
OnMessageWWW
TpszDataW
ulDataCountW
"IActiveScriptErrorWW
tRemoteGetExceptionInfoWW
pexcepinfoWW
GetSourcePositionWWW
nspdwSourceContext
pulLineNumberWWW
."plCharacterPositionW
GetSourceLineTextWWW
pbstrSourceLineW,
S{OnScriptErrorWWW
pScriptErrord
RemoveEngineSite
pEngineSiteToRemoveW
LocalDebuggeeScriptHostFactory2WX
ILocalDebuggeeScriptHostFactory2
targetProcessIdW
duplicatedReadHandle
7EduplicatedWriteHandleWWW
uiWriteHandleWWWX
InitializeWithExistingPipeWWX
%ProcessIdWWW
-IDiagnosticsMessageHandlerWW
OnExecuteScriptW
t2pScriptW
NpFileNameWWW
dOnConnectWWW
->portName
jsonData
OnDetachX
hCreateDebuggerScriptHostAtWebApp
pToolWindowW
ppWebApp 
8[JDebugEngineSiteW
RIDebugEngineSite
8mzIScriptEventProvider
EaddEventListener
teventNameWWW
~4listener
removeEventListenerW
wisEventListenerAttachedW
attachedCountWWW
rtremoveAllEventListenersW
connectW
createPortWWL
MessageDispatchW
IMessageDispatch
{loadScriptInProc
scriptFileNameWW
isAttachedWW
DebugMessagePortx
IDebugMessagePortWWWx
namex
postMessageW
;data
^spSucceededWW*
ILocalDebuggeeScriptHostFactory2 interface$
IDiagnosticsMessageHandler interfaceWW0
method addEventListener - Add an event listener.WW6
method removeEventListener - Remove an event listener.`
method isEventListenerAttached - Determine if an event listener is attached to a specific event.WWE
method removeAllEventListeners - Remove all attached event listeners.W
// Scoping function
(function () {
    // Disable the usage of ActiveX
    ActiveXObject = null;
    function EventHelper() {
        /// <summary>
        ///     This object is used as a base class for objects that require event listener functions
        ///     It stores a set of attached event listeners that are the callbacks for events,
        ///     and provides a fire event helper function that is used internally to mimic real events.
        /// </summary> 
        this.__eventListeners = {};
    }
    EventHelper.prototype.addEventListener = function (eventName, listener) {
        if (!this.__eventListeners[eventName]) {
            this.__eventListeners[eventName] = [];
        }
        this.__eventListeners[eventName].push(listener);
    };
    EventHelper.prototype.removeEventListener = function (eventName, listener) {
        if (this.__eventListeners[eventName]) {
            for (var i = 0; i < this.__eventListeners[eventName].length; i++) {
                if (this.__eventListeners[eventName][i] === listener) {
                    this.__eventListeners[eventName].splice(i, 1);
                    break;
                }
            }
        }
    };
    EventHelper.prototype.isEventListenerAttached = function (eventName, listener) {
        if (this.__eventListeners[eventName]) {
            if (listener) {
                for (var i = 0; i < this.__eventListeners[eventName].length; i++) {
                    if (this.__eventListeners[eventName][i] === callback) {
                        return 1;
                    }
                }
            } else {
                return this.__eventListeners[eventName].length;
            }
        }
        return 0;
    };
    EventHelper.prototype.removeAllEventListeners = function () {
        this.__eventListeners = [];
    };
    EventHelper.prototype.__fireEvent = function (eventName, params) {
        if (this.__eventListeners[eventName]) {
            for (var i = 0; i < this.__eventListeners[eventName].length; i++) {
                this.__eventListeners[eventName][i](params);
            }
        }
    };
    toolUI = function () {
        // Track existing ports with private access
        var privatePorts = {};
        var isAttached = true;
        var createPortInternal = function ScriptedHost$createPortInternal(portName) {
            /// <signature>
            /// <summary> 
            ///     Creates a port and its private data for storage to use later when 
            ///     connecting the incoming events from VS to the actual script objects
            ///     they correspond to.
            /// </summary>
            /// <param name='portName' type='String' optional='false'>
            ///     The portName that will identify the port
            /// </param>
            /// <returns type="Object">An object containing the internal data and the public port to return to callers.</returns>
            /// </signature>
            // Only create one port of a given name.
            if (privatePorts.hasOwnProperty(portName)) {
                throw new Error("A port with that name already exists.");
            }
            var _internalData = {
                isConnected: false,
                eventManager: new EventHelper()
            };
            var _port = {
                name: portName,
                postMessage: function (data) {
                    if (_internalData.isConnected) {
                        external.sendMessage("OnMessage", this.name, data);
                    } else {
                        throw new Error("Cannot postMessage on an unconnected port.");
                    }
                },
                addEventListener: _internalData.eventManager.addEventListener.bind(_internalData.eventManager),
                removeEventListener: _internalData.eventManager.removeEventListener.bind(_internalData.eventManager)
            };
            var privatePort = { internalData: _internalData, port: _port };
            privatePorts[portName] = privatePort;
            return privatePort;
        };
        var diagnosticsEventManager = new EventHelper();
        var breakFlags = 0;
        var hwnd = 0;
        external.addEventListener("message", function (e) {
            switch (e.commandId) {
                case "OnHWND":
                    hwnd = e.hwnd;
                    break;
                case "OnConnect":
                    var privatePort = createPortInternal(e.portName);
                    privatePort.internalData.isConnected = true;
                    diagnosticsEventManager.__fireEvent("connect", privatePort.port);
                    break;
                case "OnMessage":
                    if (privatePorts.hasOwnProperty(e.portName)) {
                        privatePorts[e.portName].internalData.eventManager.__fireEvent("message", { data: e.data });
                    } else {
                        throw new Error("Diagnostics message received for unknown port.");
                    }
                    break;
                case "OnDetach":
                    privatePorts = {};
                    isAttached = false;
                    diagnosticsEventManager.__fireEvent("detach", {});
                    break;
                case "OnBreakpointHit":
                    diagnosticsEventManager.__fireEvent("breakpointhit", {});
                    break;
                case "OnGetBreakFlagsResult":
                    breakFlags = parseInt(e.breakFlags, 10);
                    break;
                case "OnRemoteScriptError":
                    diagnosticsEventManager.__fireEvent("scripterror", e);
                    break;
            }
        });
        // Public Diagnostics API:
        var diagnostics = {
            // diagOM supports ES5
            engineSupportsES5: true,
            createPort: function ScriptedHost$Diagnostics$createPort(portName) {
                /// <signature>
                /// <summary> Creates a port to be used to talk to script running in the diagnostics engine in the remote target.</summary>
                /// <param name='portName' type='String' optional='false'>
                ///     The portName that will identify the port
                /// </param>
                /// <returns type="Object">The port object which can be connected, postMessage'd and listened on (using the "message event").</returns>
                /// </signature>
                return createPortInternal(portName).port;
            },
            connect: function ScriptedHost$Diagnostics$connect(port) {
                /// <signature>
                /// <summary> Connects a port to the remote target - on the remote side, a "connect" event will be fired with the other end of the port.</summary>
                /// <param name='port' type='Object' optional='false'>
                ///     The port to connect to the remote side.
                /// </param>
                /// </signature>
                if (!privatePorts.hasOwnProperty(port.name)) {
                    throw new Error("You must use a port created by ScriptedHost.Diagnostics.createPort");
                }
                external.sendMessage("OnConnect", port.name);
                privatePorts[port.name].internalData.isConnected = true;
            },
            addEventListener: diagnosticsEventManager.addEventListener.bind(diagnosticsEventManager),
            removeEventListener: diagnosticsEventManager.removeEventListener.bind(diagnosticsEventManager),
            getBreakFlags: function () {
                // sendMessage requires at least one after the message ID string, however we don't use any for GetBreakFlags
                external.sendMessage("GetBreakFlags", "empty");
                // GetBreakFlags triggers a synchronous message back to us of commandId "OnGetBreakFlagsResult" which sets breakFlags above.
                return breakFlags; 
            },
            getHWND: function () {
                external.sendMessage("GetHWND", "empty");
                // A synchronous message will be sent back which will update the value of hwnd above.
                return hwnd;
            },
            takeMemorySnapshot: function (portName, uid, startPartId) {
                external.sendMessage("TakeMemorySnapshot", portName, uid, "" + startPartId);
            }
        };
        return diagnostics;
    }();
    // Hacks to get console working without code changes
    mainBrowser = browser;
})();
