Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-servicingstack_31bf3856ad364e35_10.0.22621.440_none_6b7481ba906bf220\drupdate.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-devices-config-l1-1-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-com-l1-1-0.dll
    api-ms-win-core-string-l2-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-string-obsolete-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-heap-obsolete-l1-1-0.dll
    api-ms-win-security-lsalookup-l2-1-0.dll
    api-ms-win-core-debug-l1-1-0.dll
    api-ms-win-core-registry-l2-1-0.dll
    api-ms-win-core-timezone-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-version-l1-1-0.dll
    api-ms-win-core-privateprofile-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    ntdll.dll
    OLEAUT32.dll
    CFGMGR32.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-core-file-l2-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-core-io-l1-1-0.dll
    api-ms-win-core-memory-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-2-0.dll

  Section contains the following exports for DrUpdate.dll

    00000000 characteristics
    A3099D11 time date stamp
        0.00 version
           1 ordinal base
          12 number of functions
          12 number of names

    ordinal hint RVA      name

         11    0 000086A0 DllCanUnloadNow
         12    1 000086C0 DllCsiGetHandler
          1    2 000088E0 DriverUpdateCloseContext
          2    3 000089E0 DriverUpdateEnableDeviceInstall
          3    4 00008B00 DriverUpdateInstallUpdates
          4    5 00008C10 DriverUpdateOpenContext
          5    6 00008D50 DriverUpdateQueryUpdatesInstallStatus
          6    7 00008E90 DriverUpdateQueryUpdatesUninstallStatus
          7    8 00008FD0 DriverUpdateStageUpdates
          8    9 000090E0 DriverUpdateUninstallUpdates
          9    A 000091F0 DriverUpdateUnstageUpdates
         10    B 0000ADC0 InstallDriversOffline

  Section contains the following imports:

    msvcrt.dll
             18004CF90 Import Address Table
             18005F618 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         51D wcsrchr
                         2AA _purecall
                          C8 _callnewh
                         2B4 _resetstkoflw
                          5E __C_specific_handler
                         376 _vsnwprintf
                         397 _wcsicmp
                         51A wcsncpy_s
                         493 malloc
                         459 free
                         4A0 memcpy_s
                          5A _XcptFilter
                          B7 _amsg_exit
                         189 _initterm
                         347 _ultow_s
                         4E9 swprintf_s
                         3A1 _wcsnicmp
                         4F7 toupper
                         370 _vsnprintf
                         528 wcstoul
                         2DB _snprintf_s
                         4DA strncmp
                         10E _errno
                         4B6 realloc
                         1F2 _lock
                         34E _unlock
                          84 __dllonexit
                         29C _onexit
                         4A3 memset
                         50E wcschr
                         49E memcmp
                         49F memcpy
                         4A1 memmove
                         50F wcscmp

    api-ms-win-core-errorhandling-l1-1-0.dll
             18004CA78 Import Address Table
             18005F100 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 SetLastError
                           6 UnhandledExceptionFilter
                           5 SetUnhandledExceptionFilter
                           2 RaiseException
                           1 GetLastError
                           3 SetErrorMode

    api-ms-win-core-libraryloader-l1-1-0.dll
             18004CBB0 Import Address Table
             18005F238 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 FreeLibrary
                           8 GetModuleFileNameW
                           F LoadLibraryExW
                          16 SizeofResource
                           7 GetModuleFileNameA
                           C GetModuleHandleW
                           1 DisableThreadLibraryCalls
                          10 LoadResource
                           D GetProcAddress
                           2 FindResourceExW

    api-ms-win-service-management-l1-1-0.dll
             18004CF60 Import Address Table
             18005F5E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 OpenSCManagerW
                           0 CloseServiceHandle
                           5 OpenServiceW

    api-ms-win-core-sysinfo-l1-1-0.dll
             18004CE28 Import Address Table
             18005F4B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A GetSystemTimeAsFileTime
                           C GetSystemWindowsDirectoryW
                           E GetTickCount64
                           D GetTickCount
                           2 GetLocalTime

    api-ms-win-service-winsvc-l1-1-0.dll
             18004CF80 Import Address Table
             18005F608 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ControlService

    api-ms-win-core-synch-l1-2-0.dll
             18004CE18 Import Address Table
             18005F4A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 Sleep

    api-ms-win-devices-config-l1-1-0.dll
             18004CEA0 Import Address Table
             18005F528 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          18 CM_Locate_DevNodeW
                           D CM_Get_DevNode_Status
                          21 CM_Set_DevNode_Registry_PropertyW
                          23 CM_Setup_DevNode
                           1 CM_Delete_DevNode_Key
                           C CM_Get_DevNode_Registry_PropertyW
                           F CM_Get_Device_ID_ListW
                          10 CM_Get_Device_ID_List_SizeW
                           0 CM_Delete_Class_Key
                          24 CM_Uninstall_DevNode

    api-ms-win-core-registry-l1-1-0.dll
             18004CCC0 Import Address Table
             18005F348 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 RegCloseKey
                           9 RegDeleteValueW
                           C RegEnumKeyExW
                          21 RegQueryValueExW
                          16 RegLoadKeyW
                          2A RegUnLoadKeyW
                           F RegFlushKey
                          25 RegSaveKeyExW
                          1F RegQueryInfoKeyW
                          28 RegSetValueExW
                          1C RegOpenKeyExW
                           3 RegCreateKeyExW
                          14 RegLoadAppKeyW
                           5 RegDeleteKeyExW

    api-ms-win-core-synch-l1-1-0.dll
             18004CDB8 Import Address Table
             18005F440 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F InitializeCriticalSection
                          26 WaitForMultipleObjectsEx
                          22 SleepEx
                           E EnterCriticalSection
                          13 LeaveCriticalSection
                          19 ReleaseMutex
                           A CreateMutexW
                           D DeleteCriticalSection
                          1F SetEvent
                          28 WaitForSingleObjectEx
                           6 CreateEventW

    api-ms-win-core-com-l1-1-0.dll
             18004CA38 Import Address Table
             18005F0C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          3E CoTaskMemFree
                           8 CoCreateInstance
                          3F CoTaskMemRealloc
                          3D CoTaskMemAlloc

    api-ms-win-core-string-l2-1-0.dll
             18004CD98 Import Address Table
             18005F420 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CharNextW

    api-ms-win-core-string-l1-1-0.dll
             18004CD70 Import Address Table
             18005F3F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CompareStringW
                           6 MultiByteToWideChar
                           1 CompareStringOrdinal
                           7 WideCharToMultiByte

    api-ms-win-core-string-obsolete-l1-1-0.dll
             18004CDA8 Import Address Table
             18005F430 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 lstrcmpiW

    api-ms-win-core-processthreads-l1-1-0.dll
             18004CC68 Import Address Table
             18005F2F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D GetCurrentThreadId
                           B GetCurrentProcessId
                          1C OpenThreadToken
                          2A TerminateProcess
                           C GetCurrentThread
                          27 SetThreadToken
                           A GetCurrentProcess
                          1A OpenProcessToken

    api-ms-win-security-base-l1-1-0.dll
             18004CEF8 Import Address Table
             18005F580 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 DuplicateTokenEx
                          2C GetKernelObjectSecurity
                          13 AdjustTokenPrivileges
                          28 FreeSid
                          14 AllocateAndInitializeSid
                          18 CheckTokenMembership

    api-ms-win-security-sddl-l1-1-0.dll
             18004CF40 Import Address Table
             18005F5C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ConvertStringSecurityDescriptorToSecurityDescriptorW
                           0 ConvertSecurityDescriptorToStringSecurityDescriptorW
                           3 ConvertStringSidToSidW

    api-ms-win-core-handle-l1-1-0.dll
             18004CB58 Import Address Table
             18005F1E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-heap-obsolete-l1-1-0.dll
             18004CB90 Import Address Table
             18005F218 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A LocalFree

    api-ms-win-security-lsalookup-l2-1-0.dll
             18004CF30 Import Address Table
             18005F5B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 LookupPrivilegeValueW

    api-ms-win-core-debug-l1-1-0.dll
             18004CA60 Import Address Table
             18005F0E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 OutputDebugStringA
                           1 IsDebuggerPresent

    api-ms-win-core-registry-l2-1-0.dll
             18004CD38 Import Address Table
             18005F3C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F RegEnumKeyW

    api-ms-win-core-timezone-l1-1-0.dll
             18004CE68 Import Address Table
             18005F4F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 SystemTimeToFileTime
                           1 FileTimeToSystemTime

    api-ms-win-core-file-l1-1-0.dll
             18004CAB0 Import Address Table
             18005F138 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2B GetFullPathNameW
                          18 FlushFileBuffers
                          23 GetFileInformationByHandle
                           4 CreateFileW
                          3E SetEndOfFile
                          42 SetFilePointer
                          24 GetFileSize
                           9 FileTimeToLocalFileTime
                           0 CompareFileTime
                          22 GetFileAttributesW
                           A FindClose
                          15 FindNextFileW
                          11 FindFirstFileW
                           7 DeleteFileW
                           2 CreateDirectoryW
                          48 WriteFile
                          40 SetFileAttributesW

    api-ms-win-core-processenvironment-l1-1-0.dll
             18004CC50 Import Address Table
             18005F2D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 GetCommandLineA
                           1 ExpandEnvironmentStringsW

    api-ms-win-core-version-l1-1-0.dll
             18004CE80 Import Address Table
             18005F508 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 GetFileVersionInfoSizeExW
                           0 GetFileVersionInfoExW
                           3 VerQueryValueW

    api-ms-win-core-privateprofile-l1-1-0.dll
             18004CC40 Import Address Table
             18005F2C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 GetPrivateProfileStringW

    api-ms-win-core-rtlsupport-l1-1-0.dll
             18004CD48 Import Address Table
             18005F3D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 RtlCompareMemory
                           1 RtlCaptureContext
                           7 RtlLookupFunctionEntry
                           D RtlVirtualUnwind

    api-ms-win-core-profile-l1-1-0.dll
             18004CCB0 Import Address Table
             18005F338 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    ntdll.dll
             18004D0A8 Import Address Table
             18005F730 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         385 RtlDeleteCriticalSection
                         606 RtlTimeToTimeFields
                         3C3 RtlEnterCriticalSection
                         492 RtlInitializeCriticalSection
                         4ED RtlLeaveCriticalSection
                          80 LdrGetProcedureAddress
                         2A2 NtWriteFile
                         1AD NtOpenKey
                          AE LdrUnloadDll
                         3AD RtlDosPathNameToNtPathName_U
                          7B LdrGetDllHandleEx
                         544 RtlQueryEnvironmentVariable_U
                         101 NtClose
                         11C NtCreateFile
                          22 DbgPrint
                         20A NtQueryValueKey
                         368 RtlCreateUnicodeStringFromAsciiz
                         46B RtlGetVersion
                         623 RtlUnicodeToMultiByteSize
                         622 RtlUnicodeToMultiByteN
                         51F RtlNtStatusToDosErrorNoTeb
                         25B NtSetInformationThread
                         44D RtlGetOwnerSecurityDescriptor
                         43A RtlGetGroupSecurityDescriptor
                         454 RtlGetSaclSecurityDescriptor
                         42B RtlGetDaclSecurityDescriptor
                         489 RtlInitUnicodeString
                         417 RtlGUIDFromString
                         574 RtlRandomEx
                         475 RtlImageNtHeader
                         1E5 NtQueryInformationFile
                         253 NtSetInformationFile
                         1B6 NtOpenProcess
                         1E8 NtQueryInformationProcess
                         407 RtlFormatCurrentUserKeyPath
                         414 RtlFreeUnicodeString
                         14D NtDeleteKey
                         122 NtCreateKey
                         1F3 NtQueryKey
                         274 NtSetValueKey
                         150 NtDeleteValueKey
                         15D NtEnumerateKey
                         1F9 NtQueryOpenSubKeysEx
                          8A LdrLoadDll
                         49F RtlInitializeSid
                         5F7 RtlSubAuthoritySid
                         5CA RtlSetOwnerSecurityDescriptor
                         5C2 RtlSetGroupSecurityDescriptor
                         48A RtlInitUnicodeStringEx
                         646 RtlValidRelativeSecurityDescriptor
                         4F1 RtlLengthSecurityDescriptor
                         3D2 RtlEqualUnicodeString
                         536 RtlPrefixUnicodeString
                         4F2 RtlLengthSid
                         34C RtlCreateAcl
                         2C4 RtlAddAccessAllowedAceEx
                         35F RtlCreateSecurityDescriptor
                         5BB RtlSetDaclSecurityDescriptor
                         647 RtlValidSecurityDescriptor
                         2B8 RtlAbsoluteToSelfRelativeSD
                         49E RtlInitializeSRWLock
                         2BE RtlAcquireSRWLockExclusive
                         589 RtlReleaseSRWLockExclusive
                         367 RtlCreateUnicodeString
                         1C0 NtOpenThreadToken
                         1B7 NtOpenProcessToken
                         1FF NtQuerySecurityObject
                         159 NtDuplicateToken
                          CF NtAdjustPrivilegesToken
                         346 RtlCopySid
                         2CA RtlAddAce
                         268 NtSetSecurityObject
                         160 NtEnumerateValueKey
                         61D RtlUnicodeStringToInteger
                         158 NtDuplicateObject
                         1C1 NtOpenThreadTokenEx
                         1B8 NtOpenProcessTokenEx
                         1EB NtQueryInformationToken
                         3D0 RtlEqualSid
                         339 RtlConvertSidToUnicodeString
                         2EE RtlAppendUnicodeStringToString
                          78 LdrGetDllHandle
                         47C RtlInitAnsiString
                         40D RtlFreeHeap
                         577 RtlReAllocateHeap
                         2E4 RtlAllocateHeap
                         511 RtlMultiByteToUnicodeSize
                         510 RtlMultiByteToUnicodeN
                          23 DbgPrintEx
                         648 RtlValidSid
                         572 RtlRaiseStatus
                         51E RtlNtStatusToDosError
                         205 NtQuerySystemInformation

    OLEAUT32.dll
             18004CA28 Import Address Table
             18005F0B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   277

    CFGMGR32.dll
             18004CA08 Import Address Table
             18005F090 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          C9 CM_Reenumerate_DevNode
                          17 CM_Create_DevNodeW
                           6 CMP_WaitNoPendingInstallEvents

    api-ms-win-core-localization-l1-2-0.dll
             18004CC08 Import Address Table
             18005F290 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1A GetThreadLocale
                          2F LCMapStringW

    api-ms-win-core-file-l2-1-0.dll
             18004CB40 Import Address Table
             18005F1C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 MoveFileExW
                           3 CreateHardLinkW

    api-ms-win-core-heap-l1-1-0.dll
             18004CB68 Import Address Table
             18005F1F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 HeapReAlloc
                           2 HeapAlloc
                           6 HeapFree
                           0 GetProcessHeap

    api-ms-win-core-io-l1-1-0.dll
             18004CBA0 Import Address Table
             18005F228 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 DeviceIoControl

    api-ms-win-core-memory-l1-1-0.dll
             18004CC20 Import Address Table
             18005F2A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 UnmapViewOfFile
                           2 MapViewOfFile
                           0 CreateFileMappingW

    api-ms-win-core-sysinfo-l1-2-0.dll
             18004CE58 Import Address Table
             18005F4E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 GetNativeSystemInfo

  Summary

        1000 .data
        3000 .pdata
       17000 .rdata
        1000 .reloc
        1000 .rsrc
       4A000 .text
